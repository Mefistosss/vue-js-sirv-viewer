{"version":3,"sources":["../classes/description.js"],"names":["Sirv","define","bHelpers","magicJS","globalFunctions","EventEmitter","helper","moduleName","$J","$","rootDOM","addModuleCSSByName","CSS_CONTAINER_DESCRIPTION","CSS_DESCRIPTION","Description","options","extend","text","container","$new","description","addEvents","init","addClass","node","innerHTML","createLink","append","browser","mobile","handlerTouchDragEvent","addEvent","e","stop","step","scrollTop","deltaY","isMove","lastScrollTop","lastXY","x","y","dragOn","state","getContainer","string","result","pat","replace","destroy","removeEvent"],"mappings":"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","sourcesContent":["Sirv.define(\n    'Description',\n    ['bHelpers','magicJS','globalFunctions','EventEmitter','helper'],\n    (bHelpers,magicJS,globalFunctions,EventEmitter,helper) => {\n        const moduleName = 'Description';\n        \n        const $J = magicJS;\n        const $ = $J.$;\n        \n        \n        /* start-removable-module-css */\n        globalFunctions.rootDOM.addModuleCSSByName(moduleName, () => {\n            return '.smv-sirv-container-description{display:inline-block;position:relative;width:100%;height:100%;padding:3px 8px;background:rgba(128,128,128,.9)!important;text-align:left;z-index:50;box-sizing:border-box;overflow-y:auto;overflow-x:hidden}.smv-sirv-container-description .smv-sirv-description{position:relative;color:#000!important;font-size:14px;line-height:1.4;opacity:.7;z-index:100}';\n        });\n        /* end-removable-module-css */\n        \n        /* eslint-env es6 */\n/* eslint-disable indent */\n/* eslint-disable no-lonely-if */\n/* eslint class-methods-use-this: [\"off\", { \"createLink\": [\"error\"] }] */\n/* eslint no-unused-vars: [\"error\", { \"args\": \"none\", \"varsIgnorePattern\": \"Description\" }] */\n\nconst CSS_CONTAINER_DESCRIPTION = 'smv-sirv-container-description';\nconst CSS_DESCRIPTION = 'smv-sirv-description';\n\nclass Description {\n    constructor(options) {\n        this.options = $J.extend({\n            text: ''\n        }, options || {});\n\n        this.container = $J.$new('div');\n        this.description = $J.$new('div');\n\n        this.addEvents();\n    }\n\n    init() {\n        this.container.addClass(CSS_CONTAINER_DESCRIPTION);\n        this.description.addClass(CSS_DESCRIPTION);\n\n        this.description.node.innerHTML = this.createLink(this.options.text);\n        this.container.append(this.description);\n    }\n\n    addEvents() {\n        if ($J.browser.mobile) {\n            this.handlerTouchDragEvent();\n        } else {\n            this.container.addEvent('mousescroll', (e) => {\n                e.stop();\n                const step = 20;\n                this.container.node.scrollTop += (step * e.deltaY);\n            });\n        }\n    }\n\n    handlerTouchDragEvent() {\n        let isMove = false;\n        let lastScrollTop = null;\n        const lastXY = { x: null, y: null };\n\n        const dragOn = (e) => {\n            const state = e.state;\n            e.stop();\n            if (state === 'dragstart') {\n                lastXY.y = e.y;\n                isMove = true;\n                lastScrollTop = this.container.node.scrollTop;\n            } else if (state === 'dragmove') {\n                if (isMove) {\n                    this.container.node.scrollTop = lastScrollTop - (e.y - lastXY.y);\n                }\n            } else if (state === 'dragend') {\n                if (isMove) {\n                    isMove = false;\n                }\n            }\n        };\n\n        this.container.addEvent('touchdrag', dragOn);\n    }\n\n    getContainer() {\n        return this.container;\n    }\n\n    createLink(string) {\n        let result = null;\n\n        const pat = /\\[a([^\\]]+)\\](.*?)\\[\\/a\\]/ig;\n        result = string.replace(/&amp;/g, '&')\n            .replace(/&lt;/g, '<')\n            .replace(/&gt;/g, '>')\n            .replace(pat, '<a $1>$2</a>');\n\n        return result;\n    }\n\n    destroy() {\n        this.container.removeEvent('mousescroll');\n        if ($J.browser.mobile) {\n            this.container.removeEvent('touchdrag');\n        }\n\n        this.options = null;\n        this.text = null;\n        this.container = null;\n        this.description = null;\n    }\n}\n\nreturn Description;\n\n    }\n);\n"],"file":"description.js"}