{"version":3,"sources":["../classes/contextmenu.js"],"names":["Sirv","define","bHelpers","magicJS","globalVariables","globalFunctions","moduleName","$J","$","rootDOM","addModuleCSSByName","getViewPort","pad","size","W","getSize","scroll","getScroll","left","right","width","top","bottom","height","x","y","ContextmenuInstance","target","data","cssPrefix","undefined","CSS_CLASS","conext","overlay","items","active","showBind","hideBind","hideOnScrollBind","canShow","position","fullScreenBox","setup","isExist","idOfItem","context","$new","addClass","addEvent","e","stop","forEach","item","addItem","hideFX","FX","duration","onComplete","remove","show","bind","hide","events","stopQueue","getOriginEvent","keyCode","_","appendTo","defined","separator","label","append","D","node","createTextNode","disabled","attr","typeOf","action","call","hidden","setCss","display","id","Math","floor","random","now","hideItem","showItem","disableItem","enableItem","removeAttr","_parent","body","browser","fullScreen","enabled","msFullscreenElement","pos","getClientXY","page","getPageXY","viewport","opacity","start","stopDefaults","type","p","r","getRect","setCanShow","setFullScreenBox","destroy","removeEvent","kill","ex"],"mappings":"AAAAA,IAAI,CAACC,MAAL,CACI,aADJ,EAEI,CAAC,UAAD,EAAY,SAAZ,EAAsB,iBAAtB,EAAwC,iBAAxC,CAFJ,EAGI,UAACC,QAAD,EAAUC,OAAV,EAAkBC,eAAlB,EAAkCC,eAAlC,EAAsD;AAClD,MAAMC,UAAU,GAAG,aAAnB;AAEA,MAAMC,EAAE,GAAGJ,OAAX;AACA,MAAMK,CAAC,GAAGD,EAAE,CAACC,CAAb;AAGA;;AACAH,EAAAA,eAAe,CAACI,OAAhB,CAAwBC,kBAAxB,CAA2CJ,UAA3C,EAAuD,YAAM;AACzD,WAAO,i4BAAP;AACH,GAFD;AAGA;;AAEA;;AACR;;AACA;;AAGA,MAAMK,WAAW,GAAG,UAACC,GAAD,EAAS;AACzB,QAAMC,IAAI,GAAGN,EAAE,CAACO,CAAH,CAAKC,OAAL,EAAb;AACA,QAAMC,MAAM,GAAGT,EAAE,CAACO,CAAH,CAAKG,SAAL,EAAf;AAEAL,IAAAA,GAAG,GAAGA,GAAG,IAAI,CAAb;AAEA,WAAO;AAAEM,MAAAA,IAAI,EAAEN,GAAR;AAAaO,MAAAA,KAAK,EAAEN,IAAI,CAACO,KAAL,GAAaR,GAAjC;AAAsCS,MAAAA,GAAG,EAAET,GAA3C;AAAgDU,MAAAA,MAAM,EAAET,IAAI,CAACU,MAAL,GAAcX,GAAtE;AAA2EY,MAAAA,CAAC,EAAER,MAAM,CAACQ,CAArF;AAAwFC,MAAAA,CAAC,EAAET,MAAM,CAACS;AAAlG,KAAP;AACH,GAPD,CAlB0D,CA2B1D;;;AA3B0D,MA4BpDC,mBA5BoD;AAAA;;AA6BtD,iCAAYC,MAAZ,EAAoBC,IAApB,EAA0BC,SAA1B,EAAqC;AACjC,UAAIC,SAAS,KAAKD,SAAlB,EAA6B;AACzBA,QAAAA,SAAS,GAAG,OAAZ;AACH;;AACD,WAAKE,SAAL,GAAiBF,SAAS,GAAG,cAA7B;AACA,WAAKF,MAAL,GAAcA,MAAd,CALiC,CAMjC;;AACA,WAAKK,MAAL,GAAc,IAAd;AACA,WAAKC,OAAL,GAAe,IAAf;AACA,WAAKC,KAAL,GAAa,EAAb,CATiC,CAUjC;;AAEA,WAAKC,MAAL,GAAc,KAAd;AAEA,WAAKC,QAAL,GAAgB,IAAhB;AACA,WAAKC,QAAL,GAAgB,IAAhB;AACA,WAAKC,gBAAL,GAAwB,IAAxB;AAEA,WAAKC,OAAL,GAAe,IAAf;AACA,WAAKC,QAAL,GAAgB;AAAEnB,QAAAA,GAAG,EAAE,IAAP;AAAaH,QAAAA,IAAI,EAAE;AAAnB,OAAhB;AAEA,WAAKuB,aAAL,GAAqB,IAArB;AAEA,WAAKC,KAAL,CAAWd,IAAI,IAAI,EAAnB;AACH;;AArDqD;;AAAA,WAuDtDe,OAvDsD,GAuDtD,iBAAQC,QAAR,EAAkB;AAAE,aAAO,CAAC,CAAC,KAAKV,KAAL,CAAWU,QAAX,CAAT;AAAgC,KAvDE;;AAAA,WAyDtDF,KAzDsD,GAyDtD,eAAMd,IAAN,EAAY;AAAA;;AACR,WAAKiB,OAAL,GAAetC,EAAE,CAACuC,IAAH,CAAQ,IAAR,EAAcC,QAAd,CAAuB,KAAKhB,SAA5B,EAAuCiB,QAAvC,CAAgD,mCAAhD,EAAqF,UAACC,CAAD,EAAO;AAAEA,QAAAA,CAAC,CAACC,IAAF;AAAW,OAAzG,CAAf;AAEAtB,MAAAA,IAAI,CAACuB,OAAL,CAAa,UAACC,IAAD,EAAU;AACnB,QAAA,KAAI,CAACC,OAAL,CAAaD,IAAb;AACH,OAFD;AAIA,WAAKE,MAAL,GAAc,IAAI/C,EAAE,CAACgD,EAAP,CAAU,KAAKV,OAAf,EAAwB;AAClCW,QAAAA,QAAQ,EAAE,GADwB;AAElCC,QAAAA,UAAU,EAAE,YAAM;AACd,UAAA,KAAI,CAACZ,OAAL,CAAaa,MAAb;AACH;AAJiC,OAAxB,CAAd;AAQA,WAAK/B,MAAL,CAAYqB,QAAZ,CAAqB,aAArB,EAAoC,KAAKZ,QAAL,GAAgB,KAAKuB,IAAL,CAAUC,IAAV,CAAe,IAAf,CAApD,EAfQ,CAiBR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,WAAK3B,OAAL,GAAe1B,EAAE,CAACuC,IAAH,CAAQ,KAAR,EAAeC,QAAf,CAAwB,KAAKhB,SAAL,GAAiB,UAAzC,EACdiB,QADc,CACL,mBADK,EACgB,KAAKa,IAAL,CAAUD,IAAV,CAAe,IAAf,CADhB,EAEf;AAFe,OAGdZ,QAHc,CAGL,aAHK,EAGU,UAACC,CAAD,EAAO;AAC5BA,QAAAA,CAAC,CAACC,IAAF,GAD4B,CAE5B;;AACA1C,QAAAA,CAAC,CAACyC,CAAD,CAAD,CAAKa,MAAL,CAAY,CAAZ,EAAeZ,IAAf,GAAsBa,SAAtB;AACH,OAPc,CAAf;AAQA,WAAK1B,QAAL,GAAgB7B,CAAC,CAAC,UAACyC,CAAD,EAAO;AACrB,YAAI,CAAC,KAAI,CAACd,MAAV,EAAkB;AAAE;AAAS;;AAC7Bc,QAAAA,CAAC,CAACC,IAAF;;AACA,YAAID,CAAC,CAACe,cAAF,GAAmBC,OAAnB,KAA+B,EAAnC,EAAuC;AAAE;AACrC,UAAA,KAAI,CAACJ,IAAL;AACH;AACJ,OANgB,CAAD,CAMbD,IANa,CAMR,IANQ,CAAhB;AAOArD,MAAAA,EAAE,CAACO,CAAH,CAAKkC,QAAL,CAAc,SAAd,EAAyB,KAAKX,QAA9B,EAAwC,CAAxC,EA1CQ,CA4CR;;AACA,WAAKC,gBAAL,GAAwB9B,CAAC,CAAC,UAACyC,CAAD,EAAO;AAC7B,YAAI,CAAC,KAAI,CAACd,MAAV,EAAkB;AAAE;AAAS;;AAC7B,QAAA,KAAI,CAAC0B,IAAL;AACH,OAHwB,CAAD,CAGrBD,IAHqB,CAGhB,IAHgB,CAAxB;AAIArD,MAAAA,EAAE,CAACO,CAAH,CAAKkC,QAAL,CAAc,QAAd,EAAwB,KAAKV,gBAA7B;AACH,KA3GqD;;AAAA,WA6GtDe,OA7GsD,GA6GtD,iBAAQzB,IAAR,EAAc;AACV,UAAMsC,CAAC,GAAG,IAAV;;AACA,UAAMd,IAAI,GAAG7C,EAAE,CAACuC,IAAH,CAAQ,IAAR,EAAcqB,QAAd,CAAuB,KAAKtB,OAA5B,CAAb;;AAEA,UAAItC,EAAE,CAAC6D,OAAH,CAAWxC,IAAI,CAACyC,SAAhB,CAAJ,EAAgC;AAC5BjB,QAAAA,IAAI,CAACL,QAAL,CAAc,gBAAd;AACH,OAFD,MAEO,IAAIxC,EAAE,CAAC6D,OAAH,CAAWxC,IAAI,CAAC0C,KAAhB,CAAJ,EAA4B;AAC/BlB,QAAAA,IAAI,CAACmB,MAAL,CAAYhE,EAAE,CAACiE,CAAH,CAAKC,IAAL,CAAUC,cAAV,CAAyB9C,IAAI,CAAC0C,KAA9B,CAAZ;;AACA,YAAI/D,EAAE,CAAC6D,OAAH,CAAWxC,IAAI,CAAC+C,QAAhB,KAA6B/C,IAAI,CAAC+C,QAAL,KAAkB,IAAnD,EAAyD;AACrDvB,UAAAA,IAAI,CAACwB,IAAL,CAAU,UAAV,EAAsB,IAAtB;AACH;;AACD,YAAIrE,EAAE,CAACsE,MAAH,CAAUjD,IAAI,CAACkD,MAAf,MAA2B,UAA/B,EAA2C;AACvC;AACA1B,UAAAA,IAAI,CAACJ,QAAL,CAAc,UAAd,EAA0B,UAACC,CAAD,EAAO;AAC7BA,YAAAA,CAAC,CAACC,IAAF;;AACA,gBAAI,CAACE,IAAI,CAACwB,IAAL,CAAU,UAAV,CAAL,EAA4B;AACxBV,cAAAA,CAAC,CAACL,IAAF;;AACAjC,cAAAA,IAAI,CAACkD,MAAL,CAAYC,IAAZ,CAAiBnD,IAAI,CAACkD,MAAtB,EAA8BZ,CAAC,CAAC1B,QAAhC;AACH;AACJ,WAND;AAOH;AACJ;;AAED,UAAIjC,EAAE,CAAC6D,OAAH,CAAWxC,IAAI,CAACoD,MAAhB,KAA2BpD,IAAI,CAACoD,MAAL,KAAgB,IAA/C,EAAqD;AACjD5B,QAAAA,IAAI,CAAC6B,MAAL,CAAY;AAAEC,UAAAA,OAAO,EAAE;AAAX,SAAZ;AACH;;AAED,UAAMC,EAAE,GAAGvD,IAAI,CAACuD,EAAL,IAAW,UAAUC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgB/E,EAAE,CAACgF,GAAH,EAA3B,CAAhC;AACA,WAAKrD,KAAL,CAAWiD,EAAX,IAAiB/B,IAAjB;AAEA,aAAO+B,EAAP;AACH,KA5IqD;;AAAA,WA8ItDK,QA9IsD,GA8ItD,kBAASL,EAAT,EAAa;AACT,UAAI,KAAKjD,KAAL,CAAWiD,EAAX,CAAJ,EAAoB;AAChB3E,QAAAA,CAAC,CAAC,KAAK0B,KAAL,CAAWiD,EAAX,CAAD,CAAD,CAAkBF,MAAlB,CAAyB;AAAEC,UAAAA,OAAO,EAAE;AAAX,SAAzB;AACH;AACJ,KAlJqD;;AAAA,WAoJtDO,QApJsD,GAoJtD,kBAASN,EAAT,EAAa;AACT,UAAI,KAAKjD,KAAL,CAAWiD,EAAX,CAAJ,EAAoB;AAChB3E,QAAAA,CAAC,CAAC,KAAK0B,KAAL,CAAWiD,EAAX,CAAD,CAAD,CAAkBF,MAAlB,CAAyB;AAAEC,UAAAA,OAAO,EAAE;AAAX,SAAzB;AACH;AACJ,KAxJqD;;AAAA,WA0JtDQ,WA1JsD,GA0JtD,qBAAYP,EAAZ,EAAgB;AACZ,UAAI,KAAKjD,KAAL,CAAWiD,EAAX,CAAJ,EAAoB;AAChB3E,QAAAA,CAAC,CAAC,KAAK0B,KAAL,CAAWiD,EAAX,CAAD,CAAD,CAAkBP,IAAlB,CAAuB,UAAvB,EAAmC,IAAnC;AACH;AACJ,KA9JqD;;AAAA,WAgKtDe,UAhKsD,GAgKtD,oBAAWR,EAAX,EAAe;AACX,UAAI,KAAKjD,KAAL,CAAWiD,EAAX,CAAJ,EAAoB;AAChB3E,QAAAA,CAAC,CAAC,KAAK0B,KAAL,CAAWiD,EAAX,CAAD,CAAD,CAAkBS,UAAlB,CAA6B,UAA7B;AACH;AACJ,KApKqD;;AAAA,WAsKtDjC,IAtKsD,GAsKtD,cAAKV,CAAL,EAAQ;AACJ,UAAI4C,OAAO,GAAGtF,EAAE,CAACiE,CAAH,CAAKC,IAAL,CAAUqB,IAAxB;;AAEA,UAAI,CAAC,KAAKvD,OAAV,EAAmB;AAAE;AAAS;;AAE9B,WAAKe,MAAL,CAAYJ,IAAZ;;AACA,UAAI3C,EAAE,CAACwF,OAAH,CAAWC,UAAX,CAAsBC,OAAtB,EAAJ,EAAqC;AACjC,YAAI,KAAKxD,aAAL,IAAsBlC,EAAE,CAACiE,CAAH,CAAK0B,mBAA/B,EAAoD;AAChDL,UAAAA,OAAO,GAAG,KAAKpD,aAAL,IAAsBlC,EAAE,CAACiE,CAAH,CAAK0B,mBAArC;AACH;AACJ;;AAED,WAAKjE,OAAL,CAAakC,QAAb,CAAsB0B,OAAtB;AACA,WAAKhD,OAAL,CAAaoC,MAAb,CAAoB;AAAE5D,QAAAA,GAAG,EAAE,CAAC;AAAR,OAApB,EAAqC8C,QAArC,CAA8C0B,OAA9C,EAbI,CAcJ;;AAEA,UAAMM,GAAG,GAAGlD,CAAC,CAACmD,WAAF,EAAZ;AACA,UAAIlF,IAAI,GAAGiF,GAAG,CAAC3E,CAAf;AACA,UAAIH,GAAG,GAAG8E,GAAG,CAAC1E,CAAd;AACA,UAAM4E,IAAI,GAAGpD,CAAC,CAACqD,SAAF,EAAb;AACA,WAAK9D,QAAL,CAAcnB,GAAd,GAAoBgF,IAAI,CAAC5E,CAAzB;AACA,WAAKe,QAAL,CAActB,IAAd,GAAqBmF,IAAI,CAAC7E,CAA1B;AAEA,UAAM+E,QAAQ,GAAG5F,WAAW,CAAC,CAAD,CAA5B;AACA,UAAME,IAAI,GAAG,KAAKgC,OAAL,CAAa9B,OAAb,EAAb;;AACA,UAAIwF,QAAQ,CAACpF,KAAT,GAAiBD,IAAI,GAAGL,IAAI,CAACO,KAAjC,EAAwC;AACpCF,QAAAA,IAAI,IAAIL,IAAI,CAACO,KAAb;AACH;;AAED,UAAImF,QAAQ,CAACjF,MAAT,GAAkBD,GAAG,GAAGR,IAAI,CAACU,MAAjC,EAAyC;AACrCF,QAAAA,GAAG,GAAGkF,QAAQ,CAACjF,MAAT,GAAkBT,IAAI,CAACU,MAA7B;AACH;;AAED,WAAKsB,OAAL,CAAaoC,MAAb,CAAoB;AAAE5D,QAAAA,GAAG,EAAEA,GAAP;AAAYH,QAAAA,IAAI,EAAEA,IAAlB;AAAwBgE,QAAAA,OAAO,EAAE,OAAjC;AAA0CsB,QAAAA,OAAO,EAAE;AAAnD,OAApB,EAjCI,CAkCJ;AACA;AACA;;AACA,WAAKrE,MAAL,GAAc,IAAd;AACH,KA5MqD;;AAAA,WA8MtD0B,IA9MsD,GA8MtD,cAAKZ,CAAL,EAAQ;AACJ,UAAI,CAAC,KAAKd,MAAV,EAAkB;AAAE;AAAS;;AAC7B,WAAKF,OAAL,CAAayB,MAAb,GAFI,CAGJ;AACA;AACA;;AAEA,WAAKJ,MAAL,CAAYmD,KAAZ,CAAkB;AACd,mBAAW,CAAC,CAAD,EAAI,CAAJ;AADG,OAAlB;AAIA,WAAKtE,MAAL,GAAc,KAAd;;AAEA,UAAIc,CAAJ,EAAO;AACHA,QAAAA,CAAC,CAACyD,YAAF;;AACA,YAAIzD,CAAC,CAAC0D,IAAF,KAAW,aAAf,EAA8B;AAC1B,cAAMC,CAAC,GAAG3D,CAAC,CAACqD,SAAF,EAAV;AACA,cAAMO,CAAC,GAAG,KAAKlF,MAAL,CAAYmF,OAAZ,EAAV;;AAEA,cAAID,CAAC,CAAC3F,IAAF,IAAU0F,CAAC,CAACpF,CAAZ,IAAiBqF,CAAC,CAAC1F,KAAF,IAAWyF,CAAC,CAACpF,CAA9B,IAAmCqF,CAAC,CAACxF,GAAF,IAASuF,CAAC,CAACnF,CAA9C,IAAmDoF,CAAC,CAACvF,MAAF,IAAYsF,CAAC,CAACnF,CAArE,EAAwE;AACpE,iBAAKkC,IAAL,CAAUV,CAAV;AACH;AACJ;AACJ;AACJ,KAtOqD;;AAAA,WAwOtD8D,UAxOsD,GAwOtD,oBAAWxE,OAAX,EAAoB;AAChB,WAAKA,OAAL,GAAeA,OAAf;AACH,KA1OqD;;AAAA,WA4OtDyE,gBA5OsD,GA4OtD,0BAAiBvE,aAAjB,EAAgC;AAC5B,WAAKuE,gBAAL,GAAwBvE,aAAxB;AACH,KA9OqD;;AAAA,WAgPtDwE,OAhPsD,GAgPtD,mBAAU;AACN,WAAKtF,MAAL,CAAYuF,WAAZ,CAAwB,aAAxB,EAAuC,KAAK9E,QAA5C;AACA7B,MAAAA,EAAE,CAACO,CAAH,CACKoG,WADL,CACiB,SADjB,EAC4B,KAAK7E,QADjC,EAEK6E,WAFL,CAEiB,QAFjB,EAE2B,KAAK5E,gBAFhC;;AAIA,UAAI;AACA,aAAKO,OAAL,CAAasE,IAAb;AACH,OAFD,CAEE,OAAOC,EAAP,EAAW,CACT;AACH;;AACD,UAAI;AACA,aAAKnF,OAAL,CAAakF,IAAb;AACH,OAFD,CAEE,OAAOC,EAAP,EAAW,CACT;AACH;AACJ,KAhQqD;;AAAA;AAAA;;AAmQ1D,SAAO1F,mBAAP;AAEK,CAxQL","sourcesContent":["Sirv.define(\n    'ContextMenu',\n    ['bHelpers','magicJS','globalVariables','globalFunctions'],\n    (bHelpers,magicJS,globalVariables,globalFunctions) => {\n        const moduleName = 'ContextMenu';\n        \n        const $J = magicJS;\n        const $ = $J.$;\n        \n        \n        /* start-removable-module-css */\n        globalFunctions.rootDOM.addModuleCSSByName(moduleName, () => {\n            return '.sirv-contextmenu{background-color:#fff;position:fixed;margin:0;padding:5px 0;border:1px solid #f2f2f2;border-radius:3px;color:#393939;font:normal 10pt/1.3em \\'Helvetica Neue\\',Arial,Helvetica,sans-serif;list-style:none!important;box-shadow:0 5px 10px rgba(0,0,0,.2);cursor:default;z-index:2147483647;box-sizing:border-box}.sirv-contextmenu li{padding:4px 14px}.sirv-contextmenu li:hover{background-color:#4599fe;color:#fbfdfe}.sirv-contextmenu li[disabled]{color:#b8b8b8;background-color:transparent}.sirv-contextmenu li.menu-separator{height:1px;margin:5px 0;padding:0;background:#dedede}.sirv-contextmenu-overlay{display:block!important;position:fixed!important;top:0;right:0;bottom:0;left:0;width:auto;height:auto;overflow:hidden!important;z-index:2147483647!important}.lt-ie10-magic .sirv-contextmenu-overlay{background-image:url(data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=)}';\n        });\n        /* end-removable-module-css */\n        \n        /* eslint-env es6 */\n/* eslint-disable indent */\n/* eslint quote-props: [\"error\", \"as-needed\", { \"keywords\": true, \"unnecessary\": false }] */\n\n\nconst getViewPort = (pad) => {\n    const size = $J.W.getSize();\n    const scroll = $J.W.getScroll();\n\n    pad = pad || 0;\n\n    return { left: pad, right: size.width - pad, top: pad, bottom: size.height - pad, x: scroll.x, y: scroll.y };\n};\n\n// eslint-disable-next-line no-unused-vars\nclass ContextmenuInstance {\n    constructor(target, data, cssPrefix) {\n        if (undefined === cssPrefix) {\n            cssPrefix = 'magic';\n        }\n        this.CSS_CLASS = cssPrefix + '-contextmenu';\n        this.target = target;\n        // Menu container\n        this.conext = null;\n        this.overlay = null;\n        this.items = {};\n        // this.data = data;\n\n        this.active = false;\n\n        this.showBind = null;\n        this.hideBind = null;\n        this.hideOnScrollBind = null;\n\n        this.canShow = true;\n        this.position = { top: null, left: null };\n\n        this.fullScreenBox = null;\n\n        this.setup(data || []);\n    }\n\n    isExist(idOfItem) { return !!this.items[idOfItem]; }\n\n    setup(data) {\n        this.context = $J.$new('ul').addClass(this.CSS_CLASS).addEvent('contextmenu dragstart selectstart', (e) => { e.stop(); });\n\n        data.forEach((item) => {\n            this.addItem(item);\n        });\n\n        this.hideFX = new $J.FX(this.context, {\n            duration: 200,\n            onComplete: () => {\n                this.context.remove();\n            }\n        });\n\n\n        this.target.addEvent('contextmenu', this.showBind = this.show.bind(this));\n\n        // this.overlay = $J.$new('div').setCss({\n        //     'background-image': 'url(\\'data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=\\')',\n        //     display: 'block',\n        //     overflow: 'hidden',\n        //     'z-index': '2147483647',\n        //     position: 'fixed',\n        //     top: 0, bottom: 0, left: 0, right: 0,\n        //     width: 'auto', height: 'auto'\n        // })\n\n        this.overlay = $J.$new('div').addClass(this.CSS_CLASS + '-overlay')\n        .addEvent('click contextmenu', this.hide.bind(this))\n        // .addEvent('', this.hideBind = this.hide.bind(this))\n        .addEvent('mousescroll', (e) => {\n            e.stop();\n            // this.hide();\n            $(e).events[0].stop().stopQueue();\n        });\n        this.hideBind = $((e) => {\n            if (!this.active) { return; }\n            e.stop();\n            if (e.getOriginEvent().keyCode === 27) { // Esc\n                this.hide();\n            }\n        }).bind(this);\n        $J.W.addEvent('keydown', this.hideBind, 1);\n\n        // eslint-disable-next-line no-unused-vars\n        this.hideOnScrollBind = $((e) => {\n            if (!this.active) { return; }\n            this.hide();\n        }).bind(this);\n        $J.W.addEvent('scroll', this.hideOnScrollBind);\n    }\n\n    addItem(data) {\n        const _ = this;\n        const item = $J.$new('li').appendTo(this.context);\n\n        if ($J.defined(data.separator)) {\n            item.addClass('menu-separator');\n        } else if ($J.defined(data.label)) {\n            item.append($J.D.node.createTextNode(data.label));\n            if ($J.defined(data.disabled) && data.disabled === true) {\n                item.attr('disabled', true);\n            }\n            if ($J.typeOf(data.action) === 'function') {\n                // item.addEvent('click', (e) {\n                item.addEvent('btnclick', (e) => {\n                    e.stop();\n                    if (!item.attr('disabled')) {\n                        _.hide();\n                        data.action.call(data.action, _.position);\n                    }\n                });\n            }\n        }\n\n        if ($J.defined(data.hidden) && data.hidden === true) {\n            item.setCss({ display: 'none' });\n        }\n\n        const id = data.id || 'item-' + Math.floor(Math.random() * $J.now());\n        this.items[id] = item;\n\n        return id;\n    }\n\n    hideItem(id) {\n        if (this.items[id]) {\n            $(this.items[id]).setCss({ display: 'none' });\n        }\n    }\n\n    showItem(id) {\n        if (this.items[id]) {\n            $(this.items[id]).setCss({ display: '' });\n        }\n    }\n\n    disableItem(id) {\n        if (this.items[id]) {\n            $(this.items[id]).attr('disabled', true);\n        }\n    }\n\n    enableItem(id) {\n        if (this.items[id]) {\n            $(this.items[id]).removeAttr('disabled');\n        }\n    }\n\n    show(e) {\n        let _parent = $J.D.node.body;\n\n        if (!this.canShow) { return; }\n\n        this.hideFX.stop();\n        if ($J.browser.fullScreen.enabled()) {\n            if (this.fullScreenBox || $J.D.msFullscreenElement) {\n                _parent = this.fullScreenBox || $J.D.msFullscreenElement;\n            }\n        }\n\n        this.overlay.appendTo(_parent);\n        this.context.setCss({ top: -10000 }).appendTo(_parent);\n        // this.context.setCss({ top: -10000 }).appendTo(this.overlay);\n\n        const pos = e.getClientXY();\n        let left = pos.x;\n        let top = pos.y;\n        const page = e.getPageXY();\n        this.position.top = page.y;\n        this.position.left = page.x;\n\n        const viewport = getViewPort(5);\n        const size = this.context.getSize();\n        if (viewport.right < left + size.width) {\n            left -= size.width;\n        }\n\n        if (viewport.bottom < top + size.height) {\n            top = viewport.bottom - size.height;\n        }\n\n        this.context.setCss({ top: top, left: left, display: 'block', opacity: 1 });\n        // if (8 !== $J.browser.ieMode) {\n        //     $($J.browser.getDoc()).setCss({ 'overflow': 'hidden' });\n        // }\n        this.active = true;\n    }\n\n    hide(e) {\n        if (!this.active) { return; }\n        this.overlay.remove();\n        // if (8 !== $J.browser.ieMode) {\n        //     $($J.browser.getDoc()).setCss({ 'overflow': '' });\n        // }\n\n        this.hideFX.start({\n            'opacity': [1, 0]\n        });\n\n        this.active = false;\n\n        if (e) {\n            e.stopDefaults();\n            if (e.type === 'contextmenu') {\n                const p = e.getPageXY();\n                const r = this.target.getRect();\n\n                if (r.left <= p.x && r.right >= p.x && r.top <= p.y && r.bottom >= p.y) {\n                    this.show(e);\n                }\n            }\n        }\n    }\n\n    setCanShow(canShow) {\n        this.canShow = canShow;\n    }\n\n    setFullScreenBox(fullScreenBox) {\n        this.setFullScreenBox = fullScreenBox;\n    }\n\n    destroy() {\n        this.target.removeEvent('contextmenu', this.showBind);\n        $J.W\n            .removeEvent('keydown', this.hideBind)\n            .removeEvent('scroll', this.hideOnScrollBind);\n\n        try {\n            this.context.kill();\n        } catch (ex) {\n            // empty\n        }\n        try {\n            this.overlay.kill();\n        } catch (ex) {\n            // empty\n        }\n    }\n}\n\nreturn ContextmenuInstance;\n\n    }\n);\n"],"file":"contextmenu.js"}