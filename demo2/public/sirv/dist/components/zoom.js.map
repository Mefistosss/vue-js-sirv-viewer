{"version":3,"sources":["../zoom/zoom.js"],"names":["Sirv","define","bHelpers","magicJS","globalVariables","globalFunctions","helper","Promise","EventEmitter","Zoominstance","Hint","ResponsiveImage","RoundLoader","Hotspots","moduleName","$J","$","rootDOM","addModuleCSSByName","defaults","mode","type","margin","width","oneOf","height","pan","ratio","minimum","wheel","tiles","trigger","hint","enable","text","hover","click","dblclick","map","size","browser","touchScreen","deepExtend","defaultsForMobileZoomOptions","defaultsForOutsideMode","defaultsForMobileInnerMode","defaultsForDeepZoom","ButtonClass","parent","options","events","parentNode","extend","disabledClass","isDisabled","isDisabledClassAdded","instanceNode","$new","addClass","objEach","key","value","addEvent","append","changeState","disable","removeClass","attr","removeAttr","destroy","removeEvent","remove","ZoomControls","zoomInButton","e","stop","emit","data","setParent","zoomOutButton","zoomCloseButton","show","hide","invisibleDisable","typeOfButton","Zoom","P","smv","BRAND_LANDING","stopEvent","difference","value1","value2","Math","abs","getContainerForZoom","container","result","node","D","body","hasClass","getNodeSize","count","resolve","reject","getSize","setTimeout","then","catch","Zoom_","SLIDE","TYPES","ZOOM","insideOptions","position","hideZoomForClickTrigger","zooming","mapSize","controls","outsideModeWasChanged","imageUrl","src","normalizeURL","replace","REG_URL_QUERY_STRING","queryParams","paramsFromQueryString","q","parseInt","quality","isNaN","isFullscreen","nativeFullscreen","queryParamsQuality","imageNode","loader","image","differenceBetweenSizes","currentSize","currentImageSize","isInfoLoaded","zoomIsOpened","imageShowPromise","longTapTimer","setImageCss","lastTriggerAction","isNotMouse","accountInfo","postInitState","clonedImage","isHidden","destroyed","waitingCallbacks","lastImageSize","hotspotsTurnedOn","scrollDebounce","debounce","replaceZoom","zoomDebounce","changeControlsState","zoom","getZoomData","onScrollHandler","onScroll","bind","createHotspotsClass","createSirvImage","makeOptions","Options","defaultSchema","makeGlobalOptions","contains","get","parseSchema","mobile","makeMobileOptions","getInfo","gettingInfoPromise","waitGettingInfo","wait","getImageInfo","info","getAccountInfo","dataAlt","getDescription","hotspotsData","hotspots","infoSize","getOriginSize","setOriginImageSize","err","showHint","always","FULLSCREEN","OPENING","OPENED","fullscreenState","onStartActions","_isReady","isInView","isZoomSizeExist","isStarted","isSlideShown","preload","postInit","onStopActions","zoomOut","onInView","startFullInit","isStartedFullInit","normalizeOptions","getId","createLoader","imageSettings","scale","callbackData","option","hdQuality","isHDQualitySet","srcset","setHDQuality","dppx","isOutsideZoom","createHint","message","html","clearZoom","off","zoomClassName","currentTrigger","zoomOptions","clickBehavior","createNewZoom","canIUse","canIUseOutsideZoom","imageSize","setTriggerAction","createZoom","setZoomEvents","zoomSize","scroll","W","getScroll","pos","getPosition","w","h","test","tmp","top","y","left","x","innerWidth","innerHeight","run","isShown","firstSlideAhead","finally","calcContainerSize","startGettingInfo","done","getHotspots","length","setInstanceComponentNode","setContainerSize","getBoundingClientRect","createControls","zoomable","CSS_CURSOR_ZOOM_IN","branded","nodeWithSirvClassName","getNodeWithSirvClassName","head","showSirvAd","MIN_RATIO","setDefaultZoomOptions","isDeep","defaultZoomOptions","outsidePosition","customZooming","onZoomGetImage","img","getImage","checkImage","dontLoad","setImage","onZoomCancelLoadingOfTiles","cancelLoadingImage","onZoomBeforeShow","disableAll","onZoomShown","sendEvent","onZoomHidden","pinchCloud","CLOSED","CLOSING","enableAll","showNeededElements","on","stopAll","makeZoom","onBeforeFullscreenIn","setCss","opacity","visibility","onAfterFullscreenIn","setImageWidthHeight","onBeforeFullscreenOut","onAfterFullscreenOut","onSecondSelectorClick","onMouseAction","direction","getNextMinZoom","zoomUp","openZoom","zoomDown","originSize","getImageSize","cs","is","min","realWidth","realHeight","getClearSizeWithoutProcessingSettings","tr","imageEvent","hintMessage","cbs","push","setLongTapEvents","setHoverEvents","eventHandler","isFullscreenActionEnded","pageXY","getPageXY","pointerCallback","isTouchEvent","cb","eventName","_cbs","forEach","setImageSrc","cloneNode","className","createImage","referrerPolicy","maxWidth","maxHeight","delta","move","touchDown","_start","clearTimeout","isPrimaryTouch","p","_move","customMove","_end","isOver","timer","check","_out","relatedTarget","getRelated","removeConnection","moveEvent","outEvent","isIe","getZoomImageSize","originWidth","originHeight","r","roundImageSize","toFirstLevel","longTap","hideActiveHotspotBox","imageClone","undefined","showCenter","createPinchEvent","OPEN_ZOOM","FS_OUT","FS_IN","baseMin","saveValue","compensation","maxCompensation","minCompensation","max","basePercent","setDefaultsValues","getBaseScale","onPinchStart","pinch","U","onPinchResize","block","setBasePercent","centerPoint","onPinchMove","isFullscreenEnabled","setScale","onPinchEnd","loadContent","waitToStart","start","error","getImageClassContainer","newImageSize","diff","opt","round","DPPX","getDPPX","upscale","imageRequest","showImage","_error","transition","loadImage","imageData","sendContentLoadedEvent","setCssProp","lens","isShowing","console","log","getInfoSize","isPlaceholder","_isplaceholder","getSelectorImgUrl","defOpt","getThumbnail","alt","getThumbnailData","lensContainer","zoomContainer","setLensContainer","zoomIn","force","getOriginImageUrl","minZoomFactor","onResize","getType","clearEvents","cancel"],"mappings":"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","sourcesContent":["Sirv.define(\n    'Zoom',\n    ['bHelpers','magicJS','globalVariables','globalFunctions','helper','Promise!','EventEmitter','Zoominstance','Hint','ResponsiveImage','RoundLoader','Hotspots'],\n    (bHelpers,magicJS,globalVariables,globalFunctions,helper,Promise,EventEmitter,Zoominstance,Hint,ResponsiveImage,RoundLoader,Hotspots) => {\n        const moduleName = 'Zoom';\n        \n        const $J = magicJS;\n        const $ = $J.$;\n        \n        \n        /* start-removable-module-css */\n        globalFunctions.rootDOM.addModuleCSSByName(moduleName, () => {\n            return '.smv-zoom-view{display:inline-block;position:relative;top:0;left:0;width:100%;height:100%;outline:0!important;-webkit-backface-visibility:hidden!important;backface-visibility:hidden!important;-webkit-user-select:none!important;-moz-user-select:none!important;-ms-user-select:none!important;user-select:none!important;-webkit-tap-highlight-color:transparent!important;-webkit-touch-callout:none!important;touch-action:pan-y}.smv-zoom-view::after{display:inline-block;height:100%;content:\\'\\';vertical-align:middle}.smv-zoom-view .zoom-loader{bottom:0;left:0;margin:5px}.smv-zoom-view>img.smv-zoomed-in{visibility:hidden!important}.smv-zoom-view .sirv-zoom{z-index:126}.smv .smv-slides-box .smv-zoom-view>img{display:inline-block!important;position:relative!important;width:auto;max-width:100%;height:auto;max-height:100%;margin:0;padding:0;vertical-align:middle}.zoom-controls{display:flex;position:absolute;right:16px;bottom:16px;flex-flow:row-reverse;height:28px;z-index:168}.zoom-controls>button{background-color:rgba(245,245,245,.9);color:#777}.zoom-controls>button::after,.zoom-controls>button::before{transition:opacity .2s linear;opacity:.65}.zoom-controls>button:hover::after,.zoom-controls>button:hover::before{opacity:1}.zoom-controls>button.disable::after,.zoom-controls>button.disable::before{opacity:.2}.zoom-controls>button+button{margin-right:4px}.zoom-controls .zoom-close,.zoom-controls .zoom-in,.zoom-controls .zoom-out{display:inline-block;position:relative;width:28px;height:28px;padding:0;border:1px solid #d7d7d7;border-radius:2px;outline:0;cursor:pointer}.zoom-controls .zoom-close::after,.zoom-controls .zoom-close::before,.zoom-controls .zoom-in::after,.zoom-controls .zoom-in::before,.zoom-controls .zoom-out::before{transform:translate3d(-50%,-50%,0);position:absolute;top:50%;left:50%;width:65%;border-top:2px solid currentcolor;font-size:0;line-height:100%;content:\\'\\'}.zoom-controls .zoom-close::after,.zoom-controls .zoom-in::after{transform-origin:center;border-left:1px solid}.zoom-controls .zoom-in::after{transform:translate3d(-50%,-50%,0) rotateZ(-90deg)}.zoom-controls .zoom-close{display:none!important}.zoom-controls .zoom-close::before{transform:translate3d(-50%,-50%,0) rotateZ(-45deg)}.zoom-controls .zoom-close::after{transform:translate3d(-50%,-50%,0) rotateZ(-135deg)}.smv .smv-slides-box .smv-slides .smv-slide .smv-content .sirv-hotspot-container{position:absolute!important;pointer-events:none}.smv .smv-slides-box .smv-slides .smv-slide .smv-content .sirv-hotspot-container.sirv-hotspot-overwrite-pointer-event{pointer-events:auto!important}';\n        });\n        /* end-removable-module-css */\n        \n        /* eslint-env es6 */\n/* global helper */\n/* eslint-disable no-extra-semi */\n/* eslint-disable no-unused-vars */\n/* eslint quote-props: [\"error\", \"as-needed\", { \"keywords\": true, \"unnecessary\": false }] */\n\n\nlet defaults = {\n    mode: { type: 'string', 'enum': ['top', 'left', 'right', 'bottom', 'inner', 'magnifier', 'deep'], defaults: 'inner' },\n    margin: { type: 'number', defaults: 9 },\n\n    width: {\n        oneOf: [\n            { type: 'number' },\n            { type: 'string', 'enum': ['auto'] }\n        ],\n        defaults: 'auto'\n    },\n\n    height: {\n        oneOf: [\n            { type: 'number' },\n            { type: 'string', 'enum': ['auto'] }\n        ],\n        defaults: 'auto'\n    },\n\n    pan: { type: 'boolean', defaults: false },\n\n    ratio: {\n        oneOf: [\n            { type: 'number', minimum: 0 },\n            { type: 'string', 'enum': ['max'] }\n        ],\n\n        defaults: 2.5\n    },\n\n    wheel: { type: 'boolean', defaults: true }, // Zoom in/out on mouse wheel\n\n    tiles: { type: 'boolean', defaults: true },\n\n    trigger: {\n        oneOf: [\n            { type: 'string', 'enum': ['hover', 'click', 'dblclick'] },\n            { type: 'boolean', 'enum': [false] }\n        ],\n        defaults: 'click'\n    },\n\n    hint: {\n        // hint.enable\n        enable: { type: 'boolean', defaults: true },\n        text: {\n            // hint.text.hover\n            hover: { type: 'string', defaults: 'Hover to zoom' },\n            // hint.text.click\n            click: { type: 'string', defaults: 'Click to zoom' },\n            // hint.text.dblclick\n            dblclick: { type: 'string', defaults: 'Double click to zoom' }\n        }\n    },\n\n    // Navigation map\n    map: {\n        // map.enable\n        enable: { type: 'boolean', defaults: false },\n        // map.size\n        size: { type: 'number', 'minimum': 0, 'maximum': 50, defaults: 25 } // in percentage\n    }\n};\n\nif ($J.browser.touchScreen) {\n    defaults = helper.deepExtend(defaults, {\n        hint: {\n            text: {\n                // hint.text.hover\n                hover: { defaults: 'Tap and hold to zoom' }\n            }\n        }\n    });\n}\n\nconst defaultsForMobileZoomOptions = {\n    hint: {\n        text: {\n            // hint.text.hover\n            hover: { type: 'string', defaults: 'Tap and hold to zoom' },\n            // hint.text.click\n            click: { type: 'string', defaults: 'Tap to zoom' },\n            // hint.text.dblclick\n            dblclick: { type: 'string', defaults: 'Double tap to zoom' }\n        }\n    }\n};\n\nconst defaultsForOutsideMode = {\n    trigger: {\n        oneOf: [\n            { type: 'string', 'enum': ['hover', 'click', 'dblclick'] },\n            { type: 'boolean', 'enum': [false] }\n        ],\n        defaults: 'hover'\n    }\n};\n\nconst defaultsForMobileInnerMode = {\n    trigger: {\n        oneOf: [\n            { type: 'string', 'enum': ['hover', 'click', 'dblclick'] },\n            { type: 'boolean', 'enum': [false] }\n        ],\n        defaults: 'dblclick'\n    }\n};\n\nconst defaultsForDeepZoom = {\n    ratio: {\n        oneOf: [\n            { type: 'number', minimum: 0 },\n            { type: 'string', 'enum': ['max'] }\n        ],\n\n        defaults: 'max'\n    }\n};\n\n/* eslint-env es6 */\n/* global EventEmitter */\n/* global helper */\n/* eslint-disable indent */\n/* eslint quote-props: [\"error\", \"as-needed\", { \"keywords\": true, \"unnecessary\": false }] */\n/* eslint dot-notation: [\"error\", { \"allowKeywords\": false }]*/\n\n\n// eslint-disable-next-line no-unused-vars\nclass ButtonClass extends EventEmitter {\n    constructor(parent, options, events) {\n        super();\n        this.parentNode = $(parent);\n        this.options = $J.extend({\n            'class': null,\n            disabledClass: 'disable'\n        }, options);\n\n        this.events = events || {};\n        this.isDisabled = false;\n        this.isDisabledClassAdded = false;\n\n        this.instanceNode = $J.$new('button');\n\n        if (this.options['class']) {\n            this.instanceNode.addClass(this.options['class']);\n        }\n\n        helper.objEach(this.events, (key, value) => {\n            this.instanceNode.addEvent(key, value);\n        });\n    }\n\n    append() {\n        this.parentNode.append(this.instanceNode);\n    }\n\n    changeState(disable) {\n        if (disable) {\n            this.disable(true);\n            if (!this.isDisabledClassAdded) {\n                this.isDisabledClassAdded = true;\n                this.instanceNode.addClass(this.options.disabledClass);\n            }\n        } else {\n            if (this.isDisabledClassAdded) {\n                this.isDisabledClassAdded = false;\n                this.instanceNode.removeClass(this.options.disabledClass);\n            }\n            this.disable();\n        }\n    }\n\n    disable(disable) {\n        if (disable) {\n            if (!this.isDisabled) {\n                this.isDisabled = true;\n                this.instanceNode.attr('disabled', 'disabled');\n            }\n        } else if (this.isDisabled) {\n            this.isDisabled = false;\n            this.instanceNode.removeAttr('disabled');\n        }\n    }\n\n    destroy() {\n        helper.objEach(this.events, (key, value) => {\n            this.instanceNode.removeEvent(key, value);\n        });\n\n        this.events = {};\n\n        this.changeState();\n\n        this.instanceNode.remove();\n        this.instanceNode = null;\n        super.destroy();\n    }\n}\n\n// eslint-disable-next-line no-unused-vars\nclass ZoomControls extends EventEmitter {\n    constructor(parent) {\n        super();\n        this.parentNode = $(parent);\n        this.instanceNode = $J.$new('div').addClass('zoom-controls');\n\n        this.zoomInButton = new ButtonClass(this.instanceNode, { 'class': 'zoom-in' }, {\n            'btnclick tap': (e) => {\n                e.stop();\n                this.emit('zoomControlsAction', { data: { type: 'zoomin' } });\n            }\n        });\n        this.zoomInButton.setParent(this);\n\n        this.zoomOutButton = new ButtonClass(this.instanceNode, { 'class': 'zoom-out' }, {\n            'btnclick tap': (e) => {\n                e.stop();\n                this.emit('zoomControlsAction', { data: { type: 'zoomout' } });\n            }\n        });\n        this.zoomOutButton.setParent(this);\n\n        this.zoomCloseButton = new ButtonClass(this.instanceNode, { 'class': 'zoom-close' }, {\n            'btnclick tap': (e) => {\n                e.stop();\n                this.emit('zoomControlsAction', { data: { type: 'zoomclose' } });\n            }\n        });\n        this.zoomCloseButton.setParent(this);\n\n        this.zoomInButton.append();\n        this.zoomOutButton.append();\n        this.zoomCloseButton.append();\n    }\n\n    show() { this.parentNode.append(this.instanceNode); }\n    hide() { this.instanceNode.remove(); }\n\n    invisibleDisable(disable) {\n        this.zoomInButton.disable(disable);\n        this.zoomOutButton.disable(disable);\n        this.zoomCloseButton.disable(disable);\n    }\n\n    disable(typeOfButton /* in, out */) {\n        if (typeOfButton) {\n            if (typeOfButton === 'in') {\n                this.zoomInButton.changeState(true);\n                this.zoomOutButton.changeState();\n                this.zoomCloseButton.changeState();\n            } else {\n                this.zoomOutButton.changeState(true);\n                this.zoomCloseButton.changeState(true);\n                this.zoomInButton.changeState();\n            }\n        } else {\n            this.zoomInButton.changeState();\n            this.zoomOutButton.changeState();\n            this.zoomCloseButton.changeState();\n        }\n    }\n\n    destroy() {\n        this.zoomInButton.destroy();\n        this.zoomOutButton.destroy();\n        this.zoomCloseButton.destroy();\n        this.hide();\n        super.destroy();\n    }\n}\n\n/* eslint-env es6 */\n/* global ZoomControls */\n/* global helper */\n/* global Zoominstance */\n/* global Hint */\n/* global Hotspots */\n/* global ResponsiveImage */\n/* global RoundLoader */\n/* global globalFunctions */\n/* global globalVariables */\n/* global defaults */\n/* global defaultsForDeepZoom */\n/* global defaultsForMobileZoomOptions */\n/* global defaultsForOutsideMode */\n/* global defaultsForMobileInnerMode */\n\n\n/* eslint-disable indent */\n/*eslint consistent-return: 0*/\n/* eslint quote-props: [\"error\", \"as-needed\", { \"keywords\": true, \"unnecessary\": false }] */\n/* eslint class-methods-use-this: [\"off\", { \"imageSettings\": [\"error\"] }] */\n\n\n// eslint-disable-next-line no-unused-vars\nconst Zoom = (() => {\n    const P = globalVariables.smv;\n    const BRAND_LANDING = 'https://sirv.com/about-zoom/?utm_source=client&utm_medium=sirvembed&utm_content=typeofembed(zoom)&utm_campaign=branding';\n\n    const stopEvent = (e) => { e.stop(); };\n\n    const difference = (value1, value2) => {\n        return Math.abs(value1 - value2);\n    };\n\n    const getContainerForZoom = (container) => {\n        let result = null;\n\n        while (container.node !== $J.D.node.body && !result) {\n            container = $(container.node.parentNode);\n            if (container.hasClass(P + '-slides-box')) {\n                result = container;\n            }\n        }\n\n        return result;\n    };\n\n    const getNodeSize = (node, count) => {\n        return new Promise((resolve, reject) => {\n            const size = $(node).getSize();\n\n            if (!count) { count = 100; }\n            count -= 1;\n\n            if (size.width || size.height) {\n                resolve(size);\n            } else if (count > 0) {\n                setTimeout(() => {\n                    getNodeSize(node, count).then(resolve).catch(reject);\n                }, 16);\n            } else {\n                reject(null);\n            }\n        });\n    };\n\n    class Zoom_ extends Zoominstance {\n        constructor(node, options) {\n            super(node, options, defaults);\n\n            this.type = globalVariables.SLIDE.TYPES.ZOOM;\n\n            this.insideOptions = {\n                type: 'outside', // inner, circle, square, outside\n                position: 'right', // top, left, right, bottom\n                hideZoomForClickTrigger: true,\n                zooming: true,\n                map: false,\n                mapSize: 50,\n                controls: false,\n                trigger: 'click',\n                outsideModeWasChanged: false\n            };\n\n            this.imageUrl = this.instanceNode.attr('data-src');\n\n            // Image URL\n            this.src = globalFunctions.normalizeURL(this.imageUrl.replace(globalVariables.REG_URL_QUERY_STRING, '$1'));\n\n            // Image default params\n            this.queryParams = helper.paramsFromQueryString(this.imageUrl.replace(globalVariables.REG_URL_QUERY_STRING, '$2'));\n\n            if (this.queryParams) {\n                const q = parseInt(this.queryParams.quality, 10);\n                if (isNaN(q)) {\n                    delete this.queryParams.quality;\n                } else {\n                    this.queryParams.quality = q;\n                }\n            }\n\n            this.isFullscreen = options.isFullscreen;\n            this.nativeFullscreen = options.nativeFullscreen;\n            this.queryParamsQuality = this.queryParams.quality || null;\n\n            this.imageNode = null;\n            this.loader = null;\n            this.image = null;\n            this.controls = null;\n            this.differenceBetweenSizes = 100;\n            this.currentSize = { width: 0, height: 0 };\n            this.currentImageSize = { width: 0, height: 0 };\n            this.isInfoLoaded = false;\n            this.zoomIsOpened = false;\n            this.imageShowPromise = null;\n            this.hint = null;\n            this.longTapTimer = null;\n            this.setImageCss = false;\n            this.lastTriggerAction = null;\n            this.isNotMouse = false;\n            this.accountInfo = {};\n            this.postInitState = 0;\n            this.clonedImage = null;\n            this.isHidden = false;\n            this.destroyed = false;\n            this.waitingCallbacks = [];\n\n            // just for outsize zoom\n            this.lastImageSize = { width: 0, height: 0 };\n\n            this.hotspotsTurnedOn = true;\n\n            this.scrollDebounce = helper.debounce(() => { this.replaceZoom(); }, 16);\n\n            this.zoomDebounce = helper.debounce(() => {\n                if (this.controls) {\n                    this.controls.invisibleDisable();\n                    this.changeControlsState(this.zoom.getZoomData());\n                }\n            }, 42);\n\n            this.onScrollHandler = this.onScroll.bind(this);\n\n            this.instanceNode.addEvent('selectstart', (e) => { e.stop(); });\n\n            // this.api = $J.extend(this.api, {\n                // resize: this.resize.bind(this), // parent class\n                // zoomIn: this.zoomIn.bind(this), // parent class\n                // zoomOut: this.zoomOut.bind(this), // parent class\n                // isZoomed: this.isZoomed.bind(this), // parent class\n                // isReady: this.isReady.bind(this), // parent class\n                // getOptions: this.getOptions.bind(this), // parent class\n                // hotspots: {} // parent class, hotspots api\n            // });\n\n            this.createHotspotsClass();\n            this.createSirvImage();\n        }\n\n        makeOptions() {\n            let options = new $J.Options(this.defaultSchema);\n\n            options = this.makeGlobalOptions(options);\n\n            if ($J.contains(['top', 'left', 'right', 'bottom', 'inner', 'magnifier'], options.get('mode'))) {\n                options.parseSchema(defaultsForOutsideMode, true);\n            }\n\n            if ($J.browser.touchScreen && $J.browser.mobile) {\n                options.parseSchema(defaultsForMobileZoomOptions, true);\n                options = this.makeMobileOptions(options);\n                if ($J.contains(['inner', 'deep'], options.get('mode'))) {\n                    options.parseSchema(defaultsForMobileInnerMode, true);\n                }\n            }\n\n            if (options.get('mode') === 'deep') {\n                options.parseSchema(defaultsForDeepZoom, true);\n            }\n\n            return options;\n        }\n\n        getInfo() {\n            if (!this.gettingInfoPromise) {\n                this.gettingInfoPromise = new Promise((resolve, reject) => {\n                    this.waitGettingInfo.wait(() => {\n                        this.image.getImageInfo()\n                            .then((info) => {\n                                if (!this.destroyed) {\n                                    this.isInfoLoaded = true;\n\n                                    this.accountInfo = this.image.getAccountInfo();\n                                    if (!this.dataAlt) {\n                                        this.dataAlt = this.image.getDescription();\n                                    }\n\n                                    this.hotspotsData = info.hotspots;\n                                    this.infoSize = this.image.getOriginSize();\n\n                                    if (this.hotspots) {\n                                        this.hotspots.setOriginImageSize(this.infoSize.width, this.infoSize.height);\n                                    }\n\n                                    resolve();\n                                }\n                            })\n                            .catch((err) => { if (!this.destroyed) { reject(err); } });\n                    });\n                });\n            }\n\n            return this.gettingInfoPromise;\n        }\n\n        showHint() {\n            if (this.hint) {\n                if (!this.always || $J.contains([globalVariables.FULLSCREEN.OPENING, globalVariables.FULLSCREEN.OPENED], this.fullscreenState)) {\n                    this.hint.show();\n                }\n            }\n        }\n\n        onStartActions() {\n            if (this._isReady) {\n                if (this.isInView && this.isZoomSizeExist()) {\n                    this.showHint();\n                }\n            } else if (this.isStarted) {\n                if (this.isInView && this.isSlideShown && !this.preload) {\n                    this.postInit();\n                }\n            }\n\n            super.onStartActions();\n        }\n\n        onStopActions() {\n            this.zoomOut(true);\n            if (this.hint) {\n                this.hint.hide();\n            }\n\n            super.onStopActions();\n        }\n\n        onInView(value) {\n            if (value) {\n                if (this._isReady) {\n                    if (this.isSlideShown && this.isZoomSizeExist()) {\n                        this.showHint();\n                    }\n                } else if (this.isStarted) {\n                    if (!this.isInView && (this.preload || this.isSlideShown)) {\n                        this.isInView = true;\n                        this.postInit();\n                    }\n                }\n            }\n        }\n\n        startFullInit(options) {\n            if (this.isStartedFullInit) { return; }\n            super.startFullInit(options);\n\n            // if (options && options.lensContainer) {\n            //     this.zoomContainer = options.lensContainer;\n            // }\n\n            this.normalizeOptions();\n            this.getId('zoom-');\n\n            this.instanceNode.addClass(P + '-zoom-view');\n            this.instanceNode.addEvent('mousedown', stopEvent);\n\n            this.createLoader();\n        }\n\n        imageSettings(options) {\n            if (!options) { options = {}; }\n            if (!options.imageSettings) { options.imageSettings = {}; }\n            if (!options.imageSettings.scale) { options.imageSettings.scale = {}; }\n            if (!options.callbackData) { options.callbackData = {}; }\n\n            options.imageSettings.scale.option = 'fill';\n\n            if (this.quality !== null && this.queryParamsQuality === null) {\n                if (!options.src) { options.src = {}; }\n                options.src.quality = this.quality;\n            }\n\n            const hdQuality = this.hdQuality;\n\n            if (this.queryParamsQuality === null || this.isHDQualitySet && hdQuality < this.queryParamsQuality) {\n                options.srcset = { quality: hdQuality };\n            }\n\n            return options;\n        }\n\n        setHDQuality(data) {\n            if (data.dppx > 1 && data.dppx < 1.5) {\n                if (this.queryParamsQuality === null && this.quality !== null) {\n                    data.srcset.quality = this.quality;\n                } else if (data.srcset) {\n                    delete data.srcset.quality;\n                }\n            }\n\n            return data;\n        }\n\n        isOutsideZoom() {\n            return $J.contains(['top', 'left', 'right', 'bottom'], this.option('mode'));\n        }\n\n        createHint(message) {\n            if (this.option('hint.enable')) {\n                this.hint = new Hint(this.instanceNode, {\n                    html: '<span>' + message + '<span>'\n                });\n\n                this.hint.append();\n            }\n        }\n\n        clearZoom() {\n            if (this.zoom) {\n                this.off('zooming');\n                this.off('zoomUp');\n                this.off('zoomDown');\n                if (this.imageNode) {\n                    this.imageNode.removeClass(this.zoomClassName);\n                }\n            }\n\n            super.clearZoom();\n        }\n\n        replaceZoom() {\n            let trigger = false;\n            const currentTrigger = this.option('trigger');\n            const zoomOptions = { clickBehavior: 'both' };\n\n            if (!this._isReady) { return; }\n\n            if (currentTrigger === 'hover' && this.option('mode') !== 'magnifier') {\n                if ($J.contains([globalVariables.FULLSCREEN.OPENING, globalVariables.FULLSCREEN.OPENED], this.fullscreenState)) {\n                    trigger = 'click';\n                    zoomOptions.trigger = trigger;\n                } else {\n                    trigger = currentTrigger;\n                }\n            }\n\n            let createNewZoom = false;\n            if (trigger && this.insideOptions.trigger !== trigger) {\n                createNewZoom = true;\n            }\n\n            let canIUse;\n            if (this.insideOptions.type === 'outside') {\n                canIUse = this.canIUseOutsideZoom();\n\n                if (canIUse && this.insideOptions.outsideModeWasChanged || !canIUse && !this.insideOptions.outsideModeWasChanged) {\n                    this.insideOptions.outsideModeWasChanged = !this.insideOptions.outsideModeWasChanged;\n                    createNewZoom = true;\n                }\n\n                // if the image checnge size the window of outside zoom must chenge too\n                const imageSize = this.imageNode.getSize();\n                if (!createNewZoom && canIUse && this.lastImageSize.width !== imageSize.width) {\n                    this.lastImageSize = imageSize;\n                    createNewZoom = true;\n                }\n            }\n\n            if (createNewZoom) {\n                this.clearZoom();\n                if (this.insideOptions.type === 'outside') {\n                    if (canIUse) {\n                        zoomOptions.type = 'outside';\n                    } else {\n                        zoomOptions.type = 'inner';\n\n                        if ($J.browser.mobile) {\n                            zoomOptions.pan = true;\n\n                            if (currentTrigger === 'hover') {\n                                trigger = 'dblclick';\n                                zoomOptions.trigger = trigger;\n                            }\n                        }\n                    }\n                }\n\n                if (trigger) {\n                    this.insideOptions.trigger = trigger;\n                }\n\n                this.setTriggerAction(trigger);\n                this.createZoom(zoomOptions);\n                this.setZoomEvents();\n            }\n        }\n\n        canIUseOutsideZoom() {\n            let result = false;\n\n            if (this.insideOptions.type === 'outside') {\n                if ($J.contains([globalVariables.FULLSCREEN.OPENING, globalVariables.FULLSCREEN.OPENED], this.fullscreenState)) { return result; }\n\n                const margin = this.option('margin');\n                const zoomSize = this.imageNode.getSize();\n                const scroll = $J.W.getScroll();\n                const pos = this.imageNode.getPosition();\n                const w = this.option('width');\n                const h = this.option('height');\n                const size = { width: zoomSize.width, height: zoomSize.height };\n\n                if (w !== 'auto') {\n                    if (/%$/.test(w)) {\n                        zoomSize.width = zoomSize.width / 100 * parseInt(w, 10);\n                    } else {\n                        zoomSize.width = parseInt(w, 10);\n                    }\n                }\n\n                if (h !== 'auto') {\n                    if (/%$/.test(h)) {\n                        zoomSize.height = zoomSize.height / 100 * parseInt(h, 10);\n                    } else {\n                        zoomSize.height = parseInt(h, 10);\n                    }\n                }\n\n                let tmp;\n                switch (this.insideOptions.position) {\n                    case 'top':\n                        tmp = pos.top - scroll.y - margin;\n                        if (tmp > zoomSize.height) {\n                            result = true;\n                        }\n                        break;\n                    case 'left':\n                        tmp = pos.left - scroll.x - margin;\n                        if (tmp >= zoomSize.width) {\n                            result = true;\n                        }\n                        break;\n                    case 'right':\n                        tmp = pos.left - scroll.x;\n                        tmp += (size.width + margin);\n\n                        if ($J.W.node.innerWidth - tmp >= zoomSize.width) {\n                            result = true;\n                        }\n                        break;\n                    case 'bottom':\n                        tmp = pos.top - scroll.y;\n                        tmp += (size.height + margin);\n\n                        if ($J.W.node.innerHeight - tmp >= zoomSize.height) {\n                            result = true;\n                        }\n                        break;\n                    // no default\n                }\n            }\n\n            return result;\n        }\n\n        createHotspotsClass() {\n            if (this.option('mode') === 'magnifier') { return; }\n            if (!$J.browser.mobile && this.option('trigger') === 'hover') {\n                this.hotspotsTurnedOn = false;\n            }\n\n            super.createHotspotsClass(Hotspots);\n        }\n\n        run(isShown, preload, firstSlideAhead) {\n            const result = super.run(isShown, preload, firstSlideAhead);\n\n            if (result) {\n                this.getInfo().finally(() => {\n                    this.calcContainerSize();\n\n                    if (this.isInView && (this.preload || this.isSlideShown)) {\n                        this.postInit();\n                    }\n                });\n\n                this.startGettingInfo();\n            }\n\n            return result;\n        }\n\n        done() {\n            if (!this._isReady && !this.destroyed) {\n                super.done();\n\n                if (this.hotspots) {\n                    if (!this.hotspots.getHotspots().length) {\n                        this.hotspots.setInstanceComponentNode(this.imageNode);\n                    }\n\n                    this.hotspots.setContainerSize(this.imageNode.node.getBoundingClientRect());\n                }\n\n                this.createZoom();\n                this.replaceZoom();\n                this.createControls();\n\n                const zoomable = this.isZoomSizeExist();\n\n                if (this.controls) {\n                    this.controls.disable('out');\n                    if (zoomable) {\n                        this.controls.show();\n                    }\n                }\n\n                if (this.imageNode && zoomable) {\n                    this.imageNode.addClass(globalVariables.CSS_CURSOR_ZOOM_IN);\n                }\n\n                this.setZoomEvents();\n\n                if (this.isSlideShown && this.isInView && zoomable) {\n                    this.showHint();\n                }\n\n                if (this.accountInfo.branded) {\n                    const nodeWithSirvClassName = globalFunctions.getNodeWithSirvClassName(this.instanceNode) || $J.D.node.head || $J.D.node.body;\n                    globalFunctions.rootDOM.showSirvAd(nodeWithSirvClassName, this.instanceNode, BRAND_LANDING, 'Deep zoom image viewer by Sirv');\n                }\n            }\n        }\n\n        normalizeOptions() {\n            if (this.option('mode') !== 'deep') {\n                this.option('map.enable', false);\n            }\n\n            if (this.option('mode') === 'deep' || $J.browser.mobile) {\n                this.option('pan', true);\n            }\n\n            if (this.option('mode') === 'magnifier' && !$J.browser.mobile) {\n                this.option('pan', false);\n            }\n\n            if (!this.isOutsideZoom()) {\n                if (this.option('width') === 'auto' && this.option('height') === 'auto') {\n                    this.option('width', '70%');\n                }\n            }\n\n            switch (this.option('trigger')) {\n                case 'hover':\n                    if (this.option('mode') === 'deep') {\n                        this.option('trigger', 'click');\n                    }\n                    break;\n\n                case 'click':\n                case 'dblclick':\n                    break;\n\n                default:\n                    this.option('trigger', false);\n            }\n\n            switch (this.option('mode')) {\n                case 'top':\n                case 'left':\n                case 'right':\n                case 'bottom':\n                    this.insideOptions.type = 'outside';\n                    this.insideOptions.position = this.option('mode');\n                    break;\n                case 'magnifier':\n                    this.insideOptions.type = 'circle';\n                    break;\n                case 'inner':\n                    this.insideOptions.type = 'inner';\n                    break;\n                case 'deep':\n                    this.insideOptions.type = 'deep';\n                    this.insideOptions.controls = true;\n                    break;\n\n                // no default\n            }\n\n            if (this.insideOptions.type === 'deep' && this.option('map.enable')) {\n                this.insideOptions.map = this.option('map.size') !== 0;\n                if (this.insideOptions.map) {\n                    this.insideOptions.mapSize = 100 / 50 * this.option('map.size');\n                }\n            }\n\n            this.insideOptions.trigger = this.option('trigger');\n\n            if ($J.browser.mobile) {\n                this.insideOptions.hideZoomForClickTrigger = false;\n            }\n\n            if (this.option('ratio') !== 'max' && this.option('ratio') < globalVariables.MIN_RATIO) {\n                this.option('ratio', 0);\n            }\n\n            this.setDefaultZoomOptions();\n        }\n\n        setDefaultZoomOptions() {\n            const isDeep = this.insideOptions.type === 'deep';\n\n            super.setDefaultZoomOptions();\n\n            this.defaultZoomOptions = $J.extend(this.defaultZoomOptions, {\n                trigger: this.option('trigger'),\n                tiles: this.option('tiles'),\n                width: this.option('width'),\n                height: this.option('height'),\n                map: this.insideOptions.map,\n                clickBehavior: isDeep ? 'up' : 'both',\n                outsidePosition: this.insideOptions.position,\n                margin: this.option('margin'),\n                type: isDeep ? 'inner' : this.insideOptions.type,\n                pan: this.option('pan'),\n                customZooming: this.option('wheel'),\n                mapSize: this.insideOptions.mapSize\n            });\n        }\n\n        onZoomGetImage(e) {\n            super.onZoomGetImage(e);\n\n            e.data = this.imageSettings(e.data);\n            e.data = this.setHDQuality(e.data);\n\n            const img = this.image.getImage(e.data);\n            if (this.checkImage(e.data, e.data.dontLoad)) {\n                this.zoom.setImage(img);\n            }\n        }\n\n        onZoomCancelLoadingOfTiles(e) {\n            super.onZoomCancelLoadingOfTiles(e);\n            e.data = this.imageSettings(e.data);\n            this.image.cancelLoadingImage(e.data);\n        }\n\n        // eslint-disable-next-line\n        onZoomBeforeShow(e) {\n            if (this.option('mode') !== 'magnifier') {\n                if (this.insideOptions.type === 'outside' && !this.insideOptions.outsideModeWasChanged) {\n                    this.imageNode.addClass('sirv-filter-bw');\n                } else {\n                    this.imageNode.addClass(this.zoomClassName);\n                }\n                if (this.hotspots) {\n                    this.hotspots.disableAll();\n                }\n            }\n        }\n\n        // eslint-disable-next-line\n        onZoomShown(e) {\n            if (this.isSlideShown) {\n                this.sendEvent('zoomIn', {\n                    trigger: this.option('trigger'),\n                    isOutsideZoom: this.isOutsideZoom()\n                });\n            }\n        }\n\n        // eslint-disable-next-line\n        onZoomHidden(e) {\n            this.imageNode.removeClass(this.zoomClassName);\n            this.imageNode.removeClass('sirv-filter-bw');\n\n            this.sendEvent('zoomOut');\n\n            this.isNotMouse = false;\n            this.zoomIsOpened = false;\n            if (this.pinchCloud) {\n                this.pinchCloud.addEvent();\n            }\n\n            if (this.hotspots) {\n                if (\n                    this.hotspotsTurnedOn && $J.contains([globalVariables.FULLSCREEN.CLOSED, globalVariables.FULLSCREEN.OPENING], this.fullscreenState) ||\n                    this.insideOptions.trigger !== 'hover' && $J.contains([globalVariables.FULLSCREEN.OPENED, globalVariables.FULLSCREEN.CLOSING], this.fullscreenState)\n                ) {\n                    this.hotspots.enableAll();\n\n                    if (this.isInView && this.isSlideShown) {\n                        this.hotspots.showNeededElements();\n                    }\n                }\n            }\n        }\n\n        setZoomEvents() {\n            super.setZoomEvents();\n\n            this.on('zooming', (e) => {\n                const zoom = e.data.zoom;\n                e.stopAll();\n\n                if (this.controls) {\n                    this.controls.invisibleDisable(true);\n                    this.changeControlsState(zoom);\n                    this.zoomDebounce();\n                }\n            });\n\n            this.on('zoomUp', (e) => {\n                e.stop();\n                this.makeZoom('zoomin', e.data.x, e.data.y);\n            });\n\n            this.on('zoomDown', (e) => {\n                e.stop();\n                this.makeZoom('zoomout', e.data.x, e.data.y);\n            });\n        }\n\n        // eslint-disable-next-line no-unused-vars\n        onBeforeFullscreenIn(data) {\n            if (this.zoomIsOpened) {\n                this.zoom.hide(true);\n                if (this.controls) {\n                    this.controls.disable('out');\n                }\n            }\n\n            if (this._isReady && this.isSlideShown && this.isInView && !!this.imageNode) {\n                this.isHidden = true;\n                this.imageNode.setCss({\n                    opacity: 0,\n                    visibility: 'hidden'\n                });\n            }\n\n            super.onBeforeFullscreenIn(data);\n            if (this.hotspots) {\n                this.hotspots.disableAll();\n            }\n        }\n\n        // eslint-disable-next-line no-unused-vars\n        onAfterFullscreenIn(data) {\n            this.calcContainerSize();\n            this.replaceZoom();\n\n            if (this.isHidden) {\n                this.isHidden = false;\n                setTimeout(() => {\n                    this.setImageWidthHeight();\n                    this.imageNode.setCss({\n                        opacity: '',\n                        visibility: ''\n                    });\n                }, 0);\n            }\n\n            // if we use it, we do not have pinchend event and touchdrag after that\n            // if (this.pinchCloud) {\n            //     this.pinchCloud.removeEvent();\n            //     this.pinchCloud.addEvent();\n            // }\n\n            if (this.hotspots) {\n                setTimeout(() => { // we have to wait a little bit for 'onResize' function\n                    if (this.hotspotsTurnedOn && this.fullscreenState === globalVariables.FULLSCREEN.OPENED) { // if we will exit from fullscreen before the timeout end\n                        this.hotspots.enableAll();\n                        if (this.isInView && this.isSlideShown) {\n                            this.hotspots.showNeededElements();\n                        }\n                    }\n                }, 100);\n            }\n        }\n\n        // eslint-disable-next-line no-unused-vars\n        onBeforeFullscreenOut(data) {\n            if (this.zoomIsOpened) {\n                this.zoom.hide(true);\n                if (this.controls) {\n                    this.controls.disable('out');\n                }\n            }\n\n            super.onBeforeFullscreenOut(data);\n            if (this.hotspots) {\n                if (!this.hotspotsTurnedOn) {\n                    this.hotspots.disableAll();\n                }\n            }\n\n            // if (this.option('mode') === 'magnifier') {\n            //     this.zoom.setLensContainer($J.D.node.body);\n            // }\n            this.replaceZoom();\n\n            if (this._isReady && this.isSlideShown && this.isInView && !!this.imageNode) {\n                this.isHidden = true;\n                this.imageNode.setCss({\n                    opacity: 0,\n                    visibility: 'hidden'\n                });\n            }\n        }\n\n        // eslint-disable-next-line no-unused-vars\n        onAfterFullscreenOut(data) {\n            if (this.isHidden) {\n                this.isHidden = false;\n                setTimeout(() => {\n                    if (!this.destroyed) {\n                        this.setImageWidthHeight();\n                        this.imageNode.setCss({\n                            opacity: '',\n                            visibility: ''\n                        });\n                    }\n                }, 0);\n            }\n\n            super.onAfterFullscreenOut(data);\n\n            // if we use it, we do not have pinchend event and touchdrag after that\n            // if (this.pinchCloud) {\n            //     this.pinchCloud.removeEvent();\n            //     this.pinchCloud.addEvent();\n            // }\n        }\n\n        onSecondSelectorClick() {\n            this.zoomOut(true);\n        }\n\n        onMouseAction(type) {\n            if (type === 'mouseout') {\n                if (\n                    !$J.contains(['deep', 'magnifier'], this.option('mode')) &&\n                    (\n                        this.insideOptions.type === 'outside' && this.insideOptions.outsideModeWasChanged ||\n                        this.insideOptions.type === 'inner'\n                    ) &&\n                    (\n                        this.insideOptions.trigger === 'hover' ||\n                        this.insideOptions.hideZoomForClickTrigger\n\n                    ) && !this.isNotMouse\n                ) {\n                    this.zoomOut(true);\n                }\n            }\n        }\n\n        makeZoom(direction, x, y) {\n            let result = false;\n            if (this._isReady && this.zoom) {\n                switch (direction) {\n                    case 'zoomin':\n                        if (this.zoomIsOpened) {\n                            if (this.zoom.getNextMinZoom() === 1) {\n                                this.controls.disable('in');\n                            }\n                            result = this.zoom.zoomUp(x, y);\n                        } else {\n                            result = this.openZoom(x, y, this.insideOptions.type === 'deep' ? 'first' : false);\n                        }\n                        break;\n                    case 'zoomout':\n                        if (this.zoomIsOpened) {\n                            if (this.zoom.getZoomData() === 0 || this.zoom.getNextMinZoom() === 0) {\n                                result = this.zoom.hide();\n                                if (this.controls) {\n                                    this.controls.disable('out');\n                                }\n                            } else {\n                                result = this.zoom.zoomDown(x, y);\n                            }\n                        }\n                        break;\n                    default:\n                        // why is it need\n                        if (this.zoomIsOpened) {\n                            result = this.zoom.hide();\n                            if (this.controls) {\n                                this.controls.disable('out');\n                            }\n                        }\n                }\n            }\n\n            return result;\n        }\n\n        calcContainerSize() {\n            const size = this.instanceNode.getSize();\n\n            if (!size.height || !size.width) {\n                const originSize = this.image.getOriginSize();\n\n                if (!size.height) {\n                    this.currentSize.width = size.width;\n                    this.currentSize.height = originSize.height / originSize.width * size.width;\n                } else {\n                    this.currentSize.height = size.height;\n                    this.currentSize.width = originSize.width / originSize.height * size.height;\n                }\n            } else {\n                this.currentSize = size;\n            }\n        }\n\n        getImageSize() {\n            let width;\n            let height;\n            const cs = this.currentSize;\n            const is = this.image.getOriginSize();\n\n            if (cs.width >= cs.height) {\n                height = Math.min(cs.height, is.height);\n                width = is.width / is.height * height;\n                if (width > cs.width) {\n                    width = Math.min(cs.width, is.width);\n                    height = is.height / is.width * width;\n                }\n            } else {\n                width = Math.min(cs.width, is.width);\n                height = is.height / is.width * width;\n                if (height > cs.height) {\n                    height = Math.min(cs.height, is.height);\n                    width = is.width / is.height * height;\n                }\n            }\n\n            return $J.extend({\n                realWidth: width,\n                realHeight: height,\n            }, this.image.getClearSizeWithoutProcessingSettings({ width: width, height: height }));\n        }\n\n        setTriggerAction(tr) {\n            let trigger = this.option('trigger');\n\n            this.isNotMouse = false;\n\n            if (this.option('ratio') !== 'max' && this.option('ratio') < globalVariables.MIN_RATIO) { return; }\n\n            if (trigger) {\n                let showHint = false;\n\n                if (this.lastTriggerAction) {\n                    this.lastTriggerAction();\n                    this.lastTriggerAction = null;\n\n                    if (this.hint) {\n                        this.hint.destroy();\n                        this.hint = null;\n                        showHint = true;\n                    }\n                }\n\n                if (tr) { trigger = tr; }\n\n                let imageEvent;\n                let hintMessage;\n\n                switch (trigger) {\n                    case 'click':\n                        imageEvent = 'btnclick tap';\n                        hintMessage = this.option('hint.text.click');\n                        break;\n                    case 'dblclick':\n                        imageEvent = 'dblbtnclick dbltap';\n                        hintMessage = this.option('hint.text.dblclick');\n                        break;\n                    case 'hover':\n                        imageEvent = 'mouseover';\n                        hintMessage = this.option('hint.text.hover');\n                        if ($J.browser.mobile) {\n                            if (this.outsideModeWasChanged) {\n                                hintMessage = this.option('hint.text.dblclick');\n                                imageEvent = 'dbltap';\n                                trigger = imageEvent;\n                            }\n                        }\n                        break;\n                    // no default\n                }\n\n                this.createHint(hintMessage);\n                if (showHint && this.isSlideShown && this.isInView && this.isZoomSizeExist()) {\n                    this.showHint();\n                }\n\n                const cbs = [];\n                if (trigger === 'hover') {\n                    if ($J.browser.touchScreen) {\n                        cbs.push(this.setLongTapEvents());\n                    }\n\n                    if (!$J.browser.mobile) {\n                        cbs.push(this.setHoverEvents());\n                    }\n                } else {\n                    const eventHandler = (e) => {\n                        if (this.fullscreenState === globalVariables.FULLSCREEN.OPENED || !this.always) {\n                            e.stop();\n                            if (this.isFullscreenActionEnded()) {\n                                const pageXY = e.getPageXY();\n                                this.openZoom(pageXY.x, pageXY.y, false);\n                            }\n                        }\n                    };\n\n\n                    if ($J.browser.touchScreen) {\n                        const pointerCallback = (e) => {\n                            this.isNotMouse = e.isTouchEvent();\n                        };\n\n                        this.imageNode.addEvent('pointerup', pointerCallback);\n\n                        cbs.push($((cb) => {\n                            this.isNotMouse = false;\n                            this.imageNode.removeEvent('pointerup', cb);\n                        }).bind(this, pointerCallback));\n                    }\n\n                    this.imageNode.addEvent(imageEvent, eventHandler);\n\n                    cbs.push($((eventName, cb) => {\n                        this.imageNode.removeEvent(eventName, cb);\n                    }).bind(this, imageEvent, eventHandler));\n                }\n\n                this.lastTriggerAction = $((_cbs) => {\n                    $(_cbs).forEach((cb) => { cb(); });\n                }).bind(this, cbs);\n            }\n        }\n\n        setImageSrc(src, srcset, dppx) {\n            if (this.imageNode) {\n                this.imageNode.attr('src', src);\n\n                if (srcset) {\n                    this.imageNode.attr('srcset', srcset + ' ' + dppx + 'x');\n                } else {\n                    this.imageNode.removeAttr('srcset');\n                }\n\n                this.clonedImage = $(this.imageNode.node.cloneNode(true));\n                this.clonedImage.node.className = '';\n            }\n        }\n\n        setImageWidthHeight() {\n            if (!this.destroyed) {\n                if (this.currentImageSize.realWidth / this.currentImageSize.realHeight >= this.currentSize.width / this.currentSize.height) {\n                    this.imageNode.setCss({\n                        width: '100%',\n                        height: ''\n                    });\n                } else {\n                    this.imageNode.setCss({\n                        width: '',\n                        height: '100%'\n                    });\n                }\n            }\n        }\n\n        createImage(node, src, srcset, dppx) {\n            if (!this.imageNode) {\n                if (node) {\n                    this.imageNode = $(node);\n                } else {\n                    this.imageNode = $J.$new('img');\n                }\n\n                this.imageNode.attr('referrerpolicy', this.referrerPolicy);\n\n                const originSize = this.image.getOriginSize();\n\n                this.imageNode.setCss({\n                    maxWidth: originSize.width,\n                    maxHeight: originSize.height\n                });\n\n                this.setImageWidthHeight();\n\n                this.setTriggerAction();\n\n                if (this.option('wheel') && this.option('mode') === 'deep') {\n                    this.imageNode.addEvent('mousescroll', (e) => {\n                        if (!this.zoomIsOpened && e.delta > 0) {\n                            e.stop();\n                            this.openZoom(e.x, e.y, 'first');\n                        }\n                    });\n                }\n\n                $J.W.addEvent('scroll', this.onScrollHandler);\n\n                if (this.dataAlt) {\n                    this.imageNode.attr('alt', this.dataAlt);\n                }\n\n                this.setImageSrc(src, srcset, dppx);\n            }\n        }\n\n        setLongTapEvents() {\n            let move = false;\n            let touchDown = false;\n            const _start = (e) => {\n                clearTimeout(this.longTapTimer);\n\n                if (this.zoomIsOpened || e.isTouchEvent() && !e.isPrimaryTouch()) { return; }\n\n                if (this.isFullscreenActionEnded()) {\n                    this.longTapTimer = setTimeout(() => {\n                        if (e.isTouchEvent() && !e.isPrimaryTouch()) { return; }\n                        e.stop();\n                        move = true;\n                        const p  = e.getPageXY();\n                        this.openZoom(p.x, p.y, false, true);\n                    }, 201);\n                    touchDown = true;\n                }\n            };\n            const _move = (e) => {\n                if (e.isTouchEvent() && !e.isPrimaryTouch(e)) { return; }\n                if (move) {\n                    e.stop();\n                    const p  = e.getPageXY();\n                    this.zoom.customMove(p.x, p.y);\n                } else {\n                    clearTimeout(this.longTapTimer);\n                }\n            };\n            const _end = (e) => {\n                if (e.isTouchEvent() && !e.isPrimaryTouch(e)) { return; }\n                if (touchDown) {\n                    // e.stop();\n                    touchDown = false;\n                    clearTimeout(this.longTapTimer);\n                }\n\n                if (move) {\n                    e.stop();\n                    move = false;\n                    this.zoom.hide(true);\n                }\n            };\n\n            if (this.fullscreenState === globalVariables.FULLSCREEN.OPENED || !this.always) {\n                this.instanceNode.addEvent('touchstart pointerdown', _start);\n                this.instanceNode.addEvent('touchmove pointermove', _move);\n                this.instanceNode.addEvent('touchend pointerup', _end);\n            }\n\n            return () => {\n                this.instanceNode.removeEvent('touchstart pointerdown', _start);\n                this.instanceNode.removeEvent('touchmove pointermove', _move);\n                this.instanceNode.removeEvent('touchend pointerup', _end);\n            };\n        }\n\n        setHoverEvents() {\n            let isOver = false;\n            let x;\n            let y;\n            let timer;\n            const check = () => {\n                return $J.browser.touchScreen && !$J.browser.mobile;\n            };\n            const _move = (e) => {\n                const pageXY = e.getPageXY();\n                x = pageXY.x;\n                y = pageXY.y;\n\n                if (check() && e.isTouchEvent()) {\n                    return;\n                }\n\n                if (!isOver && this.isSlideShown && (this.fullscreenState === globalVariables.FULLSCREEN.OPENED || !this.always)) {\n                    isOver = true;\n\n                    timer = setTimeout(() => {\n                        // the scroll is not needed for inner zoom\n                        this.openZoom(x, y, false);\n                    }, 84);\n                }\n            };\n\n            const _out = (e) => {\n                let relatedTarget = $(e.getRelated());\n\n                if (check() && e.isTouchEvent()) {\n                    return;\n                }\n\n                if (isOver && (this.fullscreenState === globalVariables.FULLSCREEN.OPENED || !this.always)) {\n                    isOver = false;\n\n                    if (this.isFullscreenActionEnded()) {\n                        while (relatedTarget && relatedTarget !== this.imageNode.node && relatedTarget !== $J.D.node.body) {\n                            relatedTarget = $(relatedTarget.parentNode);\n                        }\n\n                        if (relatedTarget !== this.imageNode.node) {\n                            x = null;\n                            y = null;\n                            clearTimeout(timer);\n                        }\n                    }\n                }\n            };\n\n            let removeConnection = () => {};\n            let moveEvent = 'mousemove';\n            let outEvent = 'mouseout';\n\n            if (check() && helper.isIe()) {\n                removeConnection = this.on('zoomHidden', (e) => { e.stop(); isOver = false; });\n                moveEvent = 'pointermove';\n                outEvent = 'pointerup';\n            }\n\n            this.imageNode.addEvent(moveEvent, _move);\n            this.imageNode.addEvent(outEvent, _out);\n\n            return () => {\n                removeConnection();\n                this.imageNode.removeEvent(moveEvent, _move);\n                this.imageNode.removeEvent(outEvent, _out);\n            };\n        }\n\n        getZoomImageSize() {\n            const originSize = this.image.getOriginSize();\n            const originWidth = originSize.width;\n            const originHeight = originSize.height;\n            const r = this.option('ratio');\n            let size = { width: originWidth, height: originHeight };\n\n            if (r !== 'max') {\n                // because proportions can change\n                size.width = this.currentImageSize.realWidth * r;\n                size.height = this.currentImageSize.realHeight * r;\n                size = ResponsiveImage.roundImageSize(size);\n            }\n\n            size.width = Math.min(originWidth, size.width);\n            size.height = Math.min(originHeight, size.height);\n\n            return {\n                width: size.width,\n                height: size.height,\n                originWidth: originWidth,\n                originHeight: originHeight\n            };\n        }\n\n        openZoom(x, y, toFirstLevel, longTap) {\n            if (this.insideOptions.type === 'deep' && toFirstLevel !== 'zero') {\n                toFirstLevel = 'first';\n            }\n\n            let result = false;\n\n            if (!this.zoom || !this.isZoomSizeExist()) { return result; }\n\n            // this.zoomIsOpened = img;\n            this.zoomIsOpened = true;\n\n            if (this.hint) {\n                this.hint.hide();\n            }\n\n            if (this.hotspots) {\n                this.hotspots.hideActiveHotspotBox(true);\n            }\n\n            const imageClone = this.clonedImage;\n            const zoomSize = this.getZoomImageSize();\n\n            if (undefined === x) {\n                result = this.zoom.showCenter(imageClone, zoomSize, toFirstLevel);\n            } else {\n                result = this.zoom.show(imageClone, zoomSize, x, y, longTap, toFirstLevel);\n            }\n\n            return result;\n        }\n\n        createPinchEvent() {\n            // difference between scale\n            const OPEN_ZOOM = 1.1;\n            const FS_OUT = 0.2;\n            const FS_IN = 2;\n\n            let scale;\n            let baseMin;\n            let saveValue;\n            let compensation;\n            let maxCompensation;\n            let minCompensation;\n            let max;\n            let min;\n            let basePercent;\n\n            const setDefaultsValues = () => {\n                maxCompensation = 1;\n                minCompensation = 1;\n                baseMin = this.zoom.getBaseScale().x;\n                max = 1;\n                min = baseMin;\n                saveValue = 1 - baseMin;\n            };\n\n            super.createPinchEvent(this.instanceNode);\n\n            this.pinchCloud.onPinchStart = (e) => {\n                if ($J.contains([globalVariables.FULLSCREEN.OPENING, globalVariables.FULLSCREEN.CLOSING], this.fullscreenState) ||\n                    this.insideOptions.type === 'outside' && !this.insideOptions.outsideModeWasChanged) { return; }\n\n                this.pinchCloud.pinch = true;\n                clearTimeout(this.longTapTimer);\n                basePercent = false;\n                this.pinchCloud.scale = e.scale;\n                compensation = 1;\n\n                if (this.hotspots) {\n                    this.hotspots.hideActiveHotspotBox(true);\n                }\n\n                if (this.zoomIsOpened) {\n                    compensation = this.zoom.scale.x;\n                    if (baseMin === $J.U) {\n                        setDefaultsValues();\n                    }\n\n                    compensation /= baseMin;\n                }\n                this.sendEvent('pinchStart');\n            };\n\n            this.pinchCloud.onPinchResize = (e) => {\n                if (this.pinchCloud.pinch && !this.pinchCloud.block) {\n                    if (this.zoom && this.fullscreenState === globalVariables.FULLSCREEN.OPENED && this.zoomIsOpened) {\n                        this.pinchCloud.scale = e.scale;\n                        this.zoom.setBasePercent(e.centerPoint);\n                    }\n                }\n            };\n\n            this.pinchCloud.onPinchMove = (e) => {\n                if (this.pinchCloud.pinch && !this.pinchCloud.block) {\n                    if (this.fullscreenState === globalVariables.FULLSCREEN.OPENED || !this.isFullscreenEnabled) {\n                        if (!this.zoomIsOpened) {\n                            if (e.scale > OPEN_ZOOM) {\n                                if (this.option('mode') !== 'magnifier' && this.option('wheel')) {\n                                    this.openZoom(e.centerPoint.x, e.centerPoint.y, 'zero');\n\n                                    setDefaultsValues();\n                                    compensation = 1;\n                                }\n                            } else if (e.scale < FS_OUT && this.isFullscreenEnabled) {\n                                this.pinchCloud.block = true;\n                                this.sendEvent('fullscreenOut');\n                            }\n                        } else if (this.zoom) {\n                            if (!basePercent) {\n                                basePercent = true;\n                                this.zoom.setBasePercent(e.centerPoint);\n                            } else {\n                                scale = e.scale;\n                                scale *= baseMin;\n\n                                if (max < scale) {\n                                    max = scale;\n\n                                    min = baseMin;\n                                    minCompensation = 1;\n\n                                    maxCompensation = saveValue / (max - baseMin);\n                                }\n\n                                if (min > scale) {\n                                    min = scale;\n\n                                    max = 1;\n                                    maxCompensation = 1;\n\n                                    minCompensation = baseMin / min;\n                                }\n\n                                scale *= compensation;\n\n                                scale = (baseMin + (scale - baseMin) * maxCompensation) * minCompensation;\n\n                                this.zoom.setScale(scale, e.centerPoint.x, e.centerPoint.y);\n                            }\n                            this.pinchCloud.scale = e.scale;\n                        }\n                    } else if (e.scale >= FS_IN) {\n                        this.pinchCloud.block = true;\n                        this.sendEvent('fullscreenIn');\n                    }\n                }\n            };\n\n            // eslint-disable-next-line\n            this.pinchCloud.onPinchEnd = (e) => {\n                // TODO hide zoom if zoom works with this event\n                if (this.pinchCloud.pinch) {\n                    this.pinchCloud.pinch = false;\n                    this.sendEvent('pinchEnd');\n                }\n\n                if (this.zoomIsOpened) {\n                    this.pinchCloud.removeEvent();\n                }\n\n                this.pinchCloud.block = false;\n            };\n        }\n\n        loadContent() { this.postInit(); }\n\n        postInit() {\n            if (this.postInitState) { return; }\n            this.postInitState = 1;\n\n            this.waitToStart.start();\n\n            getNodeSize(this.instanceNode.node).then((size) => {\n                this.currentSize = size;\n            // eslint-disable-next-line\n            }).catch((error) => {\n                if (!this.destroyed) {\n                    this.calcContainerSize();\n                }\n            }).finally(() => {\n                if (!this.destroyed) {\n                    this.postInitState = 2;\n                    this.getImage();\n                }\n            });\n        }\n\n        getImageClassContainer() {\n            return this.image;\n        }\n\n        // checkImage(setts, dontLoad) {\n        //     let result;\n\n        //     if (dontLoad) {\n        //         result = this.image.isExist(setts); // because we do not load images with imageclass\n        //     } else {\n        //         result = this.image.isLoaded(setts);\n        //     }\n\n        //     return result;\n        // }\n\n        getImage() {\n            const newImageSize = this.getImageSize();\n            /*\n                we must do round for those values\n\n                for example without round\n                old size is 374\n                new size is 470\n                470 - 374 = 96\n                difference between those sizes is less than 100 and we won't reload for image\n                but image was loaded with size 400\n\n                with round\n                374 + round = 400\n                470 + round = 500\n\n                500 - 400 = 100 we must to reload image\n            */\n            const diff = difference(\n                ResponsiveImage.roundImageSize({ width: this.currentImageSize.width }).width,\n                ResponsiveImage.roundImageSize({ width: newImageSize.width }).width\n            );\n            let originSize;\n            let dppx;\n            const dontLoad = true;\n\n            this.setImageCss = false;\n\n            if (!this._isReady || diff >= this.differenceBetweenSizes || this.fullscreenState === globalVariables.FULLSCREEN.OPENED) {\n                // fix for if the viewer was with display none\n                if (!this._isReady && !newImageSize.width && !newImageSize.height) {\n                    setTimeout(() => {\n                        this.calcContainerSize();\n                        this.getImage();\n                    }, 16);\n                    return;\n                }\n\n                if (diff >= this.differenceBetweenSizes || this.fullscreenState === globalVariables.FULLSCREEN.OPENED || !this.currentImageSize.width) {\n                    this.currentImageSize = newImageSize;\n                }\n\n                let opt = this.imageSettings({\n                    width: this.currentImageSize.realWidth,\n                    height: this.currentImageSize.realHeight,\n                    round: true,\n                    dontLoad: dontLoad\n                });\n\n                if ($J.DPPX > 1) {\n                    originSize = this.image.getOriginSize();\n                    if (opt.height > opt.width) {\n                        dppx = helper.getDPPX(opt.round ? ResponsiveImage.roundImageSize({ height: opt.height }).height : opt.height, originSize.height, this.upscale);\n                    } else {\n                        dppx = helper.getDPPX(opt.round ? ResponsiveImage.roundImageSize({ width: opt.width }).width : opt.width, originSize.width, this.upscale);\n                    }\n\n                    opt.dppx = dppx;\n                }\n\n                opt = this.setHDQuality(opt);\n\n                if (!this.checkImage(opt, dontLoad) || !this._isReady) {\n                    this.image.getImage(opt);\n                } else {\n                    const img = this.image.getImage(opt);\n                    this.setImageSrc(img.src, img.srcset, dppx);\n                }\n            } else if (diff < this.differenceBetweenSizes) {\n                this.setImageCss = true;\n            }\n        }\n\n        imageRequest() {\n            this.image.getImage(this.imageSettings({\n                width: this.currentImageSize.width,\n                height: this.currentImageSize.height\n            }));\n        }\n\n        showImage() {\n            if (!this.imageShowPromise) {\n                this.imageShowPromise = new Promise((resolve, reject) => {\n                    let result = null;\n                    let _error = null;\n                    if (this.isInView && this.isSlideShown) {\n                        this.imageNode.setCss({ opacity: 0, transition: 'opacity .3s linear' });\n                        this.instanceNode.append(this.imageNode);\n\n                        helper.loadImage(this.imageNode.node)\n                            .then((imageData) => { result = imageData; })\n                            .catch((error) => { _error = error; })\n                            .finally(() => {\n                                if (!this.destroyed) {\n                                    this.imageNode.addEvent('transitionend', (e) => {\n                                        e.stop();\n                                        this.imageNode.removeEvent('transitionend');\n                                        this.imageNode.setCss({ opacity: '', transition: '' });\n\n                                        if (result) {\n                                            this.sendContentLoadedEvent();\n                                            resolve(result);\n                                        } else {\n                                            reject(_error);\n                                        }\n                                    });\n\n                                    this.imageNode.getSize();\n                                    this.imageNode.setCssProp('opacity', 1);\n                                }\n                            });\n                    } else {\n                        this.instanceNode.append(this.imageNode);\n                        helper.loadImage(this.imageNode.node)\n                            .then((imageData) => { result = imageData; })\n                            .catch((error) => { _error = error; })\n                            .finally(() => {\n                                if (result) {\n                                    this.sendContentLoadedEvent();\n                                    resolve(result);\n                                } else {\n                                    reject(_error);\n                                }\n                            });\n                    }\n                });\n            }\n            return this.imageShowPromise;\n        }\n\n        createLoader() {\n            this.loader = new RoundLoader(this.instanceNode, { 'class': 'zoom-loader' });\n        }\n\n        createSirvImage() {\n            if (!this.imageUrl) { return; }\n\n            this.on('imageOnload', (e) => {\n                e.stopAll();\n\n                if (e.data.callbackData.lens) {\n                    if ((this.zoom.isShown() || this.zoom.isShowing()) && this.zoomIsOpened) {\n                        this.zoom.setImage(e.data);\n                    }\n                } else if (this._isReady) {\n                    if (this.imageShowPromise) {\n                        this.setImageSrc(e.data.src, e.data.srcset, e.data.dppx);\n                    }\n                } else {\n                    this.createImage(e.data.node, e.data.src, e.data.srcset, e.data.dppx);\n\n                    this.showImage().finally(() => {\n                        if (this.loader) { this.loader.hide(); }\n                        this.done();\n                        this.sendContentLoadedEvent();\n                    });\n                }\n            });\n\n            this.on('imageOnerror', (e) => {\n                e.stopAll();\n\n                if (this.loader) { this.loader.hide(); }\n                console.log('image error');\n            });\n\n            this.image = new ResponsiveImage(this.imageUrl, { imageSettings: this.queryParams, referrerPolicy: this.referrerPolicy });\n            this.image.setParent(this);\n            this.getInfo();\n        }\n\n        getInfoSize() {\n            return new Promise((resolve, reject) => {\n                this.getInfo()\n                    .then(() => { resolve({ size: this.infoSize }); })\n                    .catch((err) => { reject({ error: err, isPlaceholder: err._isplaceholder }); });\n            });\n        }\n\n        getSelectorImgUrl(data) {\n            return new Promise((resolve, reject) => {\n                const defOpt = this.imageSettings();\n                if (defOpt.src) { data.src = defOpt.src; }\n                data.srcset = defOpt.srcset;\n\n                if (this.isInfoLoaded) {\n                    this.waitToStart.wait(() => {\n                        resolve($J.extend(this.image.getThumbnail(data), {\n                            alt: this.dataAlt\n                        }));\n                    });\n                } else {\n                    this.getInfo()\n                        .then(() => {\n                            this.waitToStart.wait(() => {\n                                resolve($J.extend(this.image.getThumbnail(data), {\n                                    alt: this.dataAlt\n                                }));\n                            });\n                        })\n                        .catch(reject);\n                }\n            });\n        }\n\n        getThumbnailData(opt) {\n            return this.image.getThumbnail(opt);\n        }\n\n        createControls() {\n            if (this.insideOptions.controls) {\n                this.controls = new ZoomControls(this.instanceNode);\n                this.controls.setParent(this);\n\n                this.on('zoomControlsAction', (e) => {\n                    e.stopAll();\n                    if (this.zoom) {\n                        this.makeZoom(e.data.type);\n                    }\n                });\n            }\n        }\n\n        changeControlsState(zoom /* from 0 to 1 */) {\n            if (this.controls) {\n                if (zoom === 1 || zoom === 0) {\n                    if (zoom === 1) {\n                        this.controls.disable('in');\n                    } else {\n                        this.controls.disable('out');\n                    }\n                } else {\n                    this.controls.disable();\n                }\n            }\n        }\n\n        createZoom(options) {\n            let result = null;\n\n            if (!this.destroyed) {\n                let lensContainer = this.zoomContainer;\n                result = super.createZoom(this.instanceNode, options);\n\n                if (this.option('mode') === 'magnifier') {\n                    lensContainer = getContainerForZoom(this.instanceNode);\n                } else if (!$J.contains([globalVariables.FULLSCREEN.OPENING, globalVariables.FULLSCREEN.OPENED], this.fullscreenState)) {\n                    if (result.type === 'outside') {\n                        lensContainer = getContainerForZoom(this.instanceNode);\n                        // because container of viewer can be overflow hidden\n                        lensContainer = $J.D.node.body;\n                    }\n                }\n\n                if (lensContainer) {\n                    this.zoom.setLensContainer(lensContainer);\n                }\n            }\n\n            return result;\n        }\n\n        zoomIn() {\n            let result = false;\n            if (this._isReady && this.zoom) {\n                if (this.option('fullscreenOnly') && this.fullscreenState === globalVariables.FULLSCREEN.CLOSED) {\n                    this.sendEvent('fullscreenIn');\n                } else {\n                    result = this.makeZoom('zoomin');\n                }\n            }\n            return result;\n        }\n\n        zoomOut(force) {\n            let result = false;\n            if (this._isReady && this.zoom) {\n                if (force) {\n                    if (this.zoomIsOpened) {\n                        result = this.zoom.hide(!this.zoom.getZoomData());\n                    }\n                } else {\n                    result = this.makeZoom('zoomout');\n                }\n            }\n            return result;\n        }\n\n        getOriginImageUrl() {\n            if (this._isReady) {\n                return this.image.getOriginImageUrl();\n            }\n\n            return null;\n        }\n\n        isZoomSizeExist() {\n            let result = false;\n\n            if (this._isReady) {\n                const minZoomFactor = 100; // like in deep zoom level calculation\n                const cs = this.currentImageSize;\n                const zoomSize = this.getZoomImageSize();\n\n                if (zoomSize.originWidth - cs.realWidth >= minZoomFactor && (this.option('ratio') === 'max' || this.option('ratio') >= globalVariables.MIN_RATIO)) {\n                    result = true;\n                }\n            }\n\n            return result;\n        }\n\n        onResize() {\n            let result = false;\n            if (this.destroyed) { return; }\n\n            if (this.isStarted && this.postInitState === 2) {\n                this.calcContainerSize();\n                this.getImage();\n\n                if (this.hotspots) {\n                    if (this.hotspotsTurnedOn && $J.contains([globalVariables.FULLSCREEN.CLOSED, globalVariables.FULLSCREEN.OPENING], this.fullscreenState) ||\n                        this.insideOptions.trigger !== 'hover' && $J.contains([globalVariables.FULLSCREEN.OPENED, globalVariables.FULLSCREEN.CLOSING], this.fullscreenState)) {\n                        this.hotspots.setContainerSize(this.imageNode.node.getBoundingClientRect());\n                        if (this.isInView && this.isSlideShown) {\n                            this.hotspots.showNeededElements();\n                        }\n                    }\n                }\n\n                if (this.imageNode) {\n                    this.setImageWidthHeight();\n\n                    if (this.isZoomSizeExist()) {\n                        this.imageNode.addClass(globalVariables.CSS_CURSOR_ZOOM_IN);\n                    } else {\n                        if (this.hint) { this.hint.hide(); }\n                        this.imageNode.removeClass(globalVariables.CSS_CURSOR_ZOOM_IN);\n                    }\n                }\n\n                result = true;\n            }\n\n            if (this.controls) {\n                if (this.isZoomSizeExist()) {\n                    this.controls.show();\n                } else {\n                    this.controls.hide();\n                }\n            }\n\n            this.replaceZoom();\n\n            if (this.zoom) {\n                this.zoom.onResize();\n            }\n\n            return result;\n        }\n\n        onScroll(e) {\n            if (this.zoomIsOpened) {\n                e.stop();\n            }\n\n            clearTimeout(this.longTapTimer);\n            this.scrollDebounce();\n        }\n\n        getType() {\n            return this.type;\n        }\n\n        destroy() {\n            this.destroyed = true;\n\n            if (this.loader) {\n                this.loader.destroy();\n                this.loader = null;\n            }\n\n            $($J.W).removeEvent('scroll', this.onScrollHandler);\n            this.onScrollHandler = null;\n\n            if (this.lastTriggerAction) {\n                this.lastTriggerAction();\n                this.lastTriggerAction = null;\n            }\n\n            if (this.hint) {\n                this.hint.destroy();\n                this.hint = null;\n            }\n\n            if (this.image) {\n                this.off('imageOnload');\n                this.off('imageOnerror');\n                this.image.destroy();\n                this.image = null;\n            }\n\n            if (this.controls) {\n                this.controls.destroy();\n                this.controls = null;\n                this.off('zoomControlsAction');\n            }\n\n            if (this.hotspots) {\n                this.hotspotsTurnedOn = false;\n                this.instanceNode.removeEvent('tap');\n            }\n\n            if (this.zoom) {\n                this.off('zooming');\n                this.off('zoomUp');\n                this.off('zoomDown');\n            }\n\n            this.instanceNode.clearEvents();\n            this.instanceNode.removeClass(P + '-zoom-view');\n\n            if (this.imageNode) {\n                this.imageNode.remove();\n                this.imageNode = null;\n            }\n\n            if (this.clonedImage) {\n                this.clonedImage = null;\n            }\n\n            this.zoomDebounce.cancel();\n            this.zoomDebounce = null;\n\n            this.scrollDebounce.cancel();\n            this.scrollDebounce = null;\n\n            clearTimeout(this.longTapTimer);\n            this.longTapTimer = null;\n\n            this.hotspotsData = null;\n\n            super.destroy();\n\n            return true;\n        }\n    }\n    return Zoom_;\n})();\n\nreturn Zoom;\n\n    }\n);\n"],"file":"zoom.js"}