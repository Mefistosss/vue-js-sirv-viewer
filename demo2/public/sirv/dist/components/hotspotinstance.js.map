{"version":3,"sources":["../classes/hotspotinstance.js"],"names":["Sirv","define","bHelpers","magicJS","Promise","Instance","moduleName","$J","$","warn","v1","v2","console","HotspotInstance","node","options","defaultSchema","hotspots","this_","api","extend","addHotspot","hotspotsData","add","isInView","isSlideShown","showNeededElements","removeHotspot","index","remove","removeAllHotspots","removeAll","getHotspots","list","createHotspotsClass","HotspotsClass","hotspotOptions","setParent","on","e","stopAll","onHotspotActivate","data","sendEvent","onHotspotDeactivate","hsData","clientRect","length","parentContainer","getParentContainer","getRightBoundengClientRect","getContainerForBoundengClientRect","appendTo","setContainerSize","showAll","done","_isReady","destroyed","createHotspots","nativeFullscreen","changeBoxContainerParent","instanceNode","getTagName","parentNode","onStartActions","onStopActions","hideActiveHotspotBox","onBeforeFullscreenIn","onBeforeFullscreenOut","onAfterFullscreenOut","destroy","off"],"mappings":"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","sourcesContent":["Sirv.define(\n    'HotspotInstance',\n    ['bHelpers','magicJS','Promise!','Instance'],\n    (bHelpers,magicJS,Promise,Instance) => {\n        const moduleName = 'HotspotInstance';\n        \n        const $J = magicJS;\n        const $ = $J.$;\n        \n        \n        /* eslint-env es6 */\n/* eslint-disable indent */\n/* global Instance */\n/* eslint-disable class-methods-use-this */\n/* eslint-disable no-unused-vars */\n/* eslint no-console: [\"error\", { allow: [\"warn\"] }] */\n/* eslint quote-props: [\"error\", \"as-needed\", { \"keywords\": true, \"unnecessary\": false }] */\n\nconst warn = (v1, v2) => {\n    console.warn('sirv.js: The ' + v1 + ' method is deprecated and will be removed. \\r\\n           Use ' + v2 + ' instead.');\n};\n\n// eslint-disable-next-line no-unused-vars\nclass HotspotInstance extends Instance {\n    constructor(node, options, defaultSchema) {\n        super(node, options, defaultSchema);\n\n        // this variable is usin in spin, zoom and image component\n        this.hotspots = null;\n\n        // API\n        const this_ = this;\n        this.api = $J.extend(this.api, {\n            addHotspot: (hotspotsData) => {\n                warn('.addHotspot()', '.hotspots.add()');\n                this_.hotspots.api.add(hotspotsData);\n                if (this_.isInView && this_.isSlideShown) {\n                    this_.hotspots.showNeededElements();\n                }\n            },\n            removeHotspot: (index) => {\n                warn('.removeHotspot()', '.hotspots.remove()');\n                this_.hotspots.api.remove(index);\n            },\n            removeAllHotspots: () => {\n                warn('.removeAllHotspots()', '.hotspots.removeAll()');\n                this_.hotspots.api.removeAll();\n            },\n            getHotspots: () => {\n                warn('.getHotspots()', '.hotspots.list()');\n                return this_.hotspots.api.list();\n            }\n        });\n    }\n\n    createHotspotsClass(HotspotsClass, hotspotOptions) {\n        this.hotspots = new HotspotsClass(hotspotOptions);\n        this.hotspots.setParent(this);\n\n        this.on('hotspotActivate', (e) => {\n            e.stopAll();\n            this.onHotspotActivate(e.data);\n            this.sendEvent('hotspotOpened');\n        });\n\n        this.on('hotspotDeactivate', (e) => {\n            e.stopAll();\n            this.onHotspotDeactivate(e.data);\n            this.sendEvent('hotspotClosed');\n        });\n\n        this.api = $J.extend(this.api, { hotspots: this.hotspots.api });\n\n        const this_ = this;\n        this.api.hotspots.add = (hsData) => {\n            if (hsData) {\n                let clientRect = null;\n                if (!this_.hotspots.getHotspots().length) {\n                    const parentContainer = this.getParentContainer();\n                    clientRect = this_.hotspots.getRightBoundengClientRect(this.getContainerForBoundengClientRect());\n                    this_.hotspots.appendTo(parentContainer);\n                }\n\n                this_.hotspots.addHotspot(hsData);\n                this_.hotspots.setContainerSize(clientRect);\n\n                this_.hotspots.showAll();\n                if (this_.isInView && this_.isSlideShown) {\n                    this_.hotspots.showNeededElements();\n                }\n            }\n        };\n    }\n\n    getContainerForBoundengClientRect() {\n        return this.getParentContainer();\n    }\n\n    done() {\n        if (!this._isReady && !this.destroyed) {\n            const parentContainer = this.getParentContainer();\n\n            if (this.hotspots) {\n                if (this.hotspotsData && this.hotspotsData.length) {\n                    this.hotspots.appendTo(parentContainer);\n                }\n\n                this.hotspots.createHotspots(this.hotspotsData);\n                if (this.nativeFullscreen) {\n                    this.hotspots.changeBoxContainerParent(true);\n                }\n                this.hotspots.showAll();\n            }\n        }\n\n        super.done();\n    }\n\n    getParentContainer() {\n        let parentContainer = this.instanceNode;\n        if (parentContainer.getTagName() === 'img') {\n            parentContainer = $(parentContainer.node.parentNode);\n        }\n\n        return parentContainer;\n    }\n\n    onHotspotActivate(data) {}\n    onHotspotDeactivate(data) {}\n\n    onStartActions() {\n        if (this.hotspots && this.isInView && this.isSlideShown) {\n            this.hotspots.showNeededElements();\n        }\n\n        super.onStartActions();\n    }\n\n    onStopActions() {\n        if (this.hotspots) {\n            this.hotspots.hideActiveHotspotBox(true);\n        }\n\n        super.onStopActions();\n    }\n\n    onBeforeFullscreenIn(data) {\n        if (this.hotspots) {\n            this.hotspots.hideActiveHotspotBox();\n            if (this.nativeFullscreen) {\n                this.hotspots.changeBoxContainerParent(true);\n            }\n        }\n    }\n\n    onBeforeFullscreenOut(data) {\n        if (this.hotspots) {\n            this.hotspots.hideActiveHotspotBox();\n            if (this.nativeFullscreen) {\n                this.hotspots.changeBoxContainerParent();\n            }\n        }\n    }\n\n    onAfterFullscreenOut(data) {\n        if (this.hotspots && this.isInView && this.isSlideShown) {\n            this.hotspots.showNeededElements();\n        }\n    }\n\n    destroy() {\n        if (this.hotspots) {\n            this.hotspots.destroy();\n        }\n        this.hotspots = null;\n\n        this.off('hotspotActivate');\n        this.off('hotspotDeactivate');\n\n        super.destroy();\n    }\n}\n\nreturn HotspotInstance;\n\n    }\n);\n"],"file":"hotspotinstance.js"}