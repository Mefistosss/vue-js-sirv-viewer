{"version":3,"sources":["../classes/hotspots.js"],"names":["Sirv","define","bHelpers","magicJS","globalFunctions","EventEmitter","Hotspot","helper","Promise","moduleName","$J","$","Hotspots","container","$new","addClass","hotspots","activeHotspots","hoveredHotspots","originImageSize","width","height","instanceComponentNode","api","add","addHotspot","bind","remove","removeHotspot","removeAll","removeAllHotspots","list","getPointerNodeHotspots","setVisibility","setStateById","enable","disable","setEvents","setOriginImageSize","appendTo","setInstanceComponentNode","instance","setContainerSize","instNodeBoundingClientRect","length","componentSize","getRightBoundengClientRect","setCss","top","left","size","getSize","dx","dy","forEach","hs","setAspectRatio","getActiveHotspot","id","filter","getHoveredHotspots","on","e","activeHotspot","data","hotspot","stopEmptyEvent","isBoxAlwaysVisible","hideBox","push","overridePointerEvent","removeOverridePointerEvent","hoveredHotspot","stopAll","clickFn","isTooltipAlwaysVisible","hideTooltip","D","addEvent","isHotspotActivated","createHotspots","hotspotsData","createHotspot","hotspotData","index","setParent","Array","isArray","hotspotsContainer","node","getBoundingClientRect","parentNode","changeBoxContainerParent","inside","c","changeBoxContainer","hideActiveHotspotBox","flag","result","show","showAll","hide","hideAll","enableAll","disableAll","showNeededElements","isEnabled","isHotspotShown","isBoxActivated","setBoxPosition","showBox","isTooltipHovered","setTooltipPosition","showTooltip","getHotspots","pointers","getHotspotPointer","destroy","removeByIndex","i","splice","rewriteHotspotIndex","startIndex","l","setId","rewriteAttrPointer","settings","setState","removeEvent","off"],"mappings":"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","sourcesContent":["Sirv.define(\n    'Hotspots',\n    ['bHelpers','magicJS','globalFunctions','EventEmitter','Hotspot','helper','Promise!'],\n    (bHelpers,magicJS,globalFunctions,EventEmitter,Hotspot,helper,Promise) => {\n        const moduleName = 'Hotspots';\n        \n        const $J = magicJS;\n        const $ = $J.$;\n        \n        \n        /* eslint-env es6 */\n/* global Hotspot */\n/* global EventEmitter */\n/* eslint quote-props: [\"error\", \"as-needed\", { \"keywords\": true, \"unnecessary\": false }] */\n/* eslint no-unused-vars: [\"error\", { \"args\": \"none\", \"varsIgnorePattern\": \"Hotspots\" }] */\n\nclass Hotspots extends EventEmitter {\n    constructor() {\n        super();\n\n        this.container = $J.$new('div').addClass('sirv-hotspot-container');\n        this.hotspots = [];\n        this.activeHotspots = [];\n        this.hoveredHotspots = [];\n        this.originImageSize = { width: 0, height: 0 };\n        this.instanceComponentNode = null;\n\n        this.api = {\n            add: this.addHotspot.bind(this),\n            remove: this.removeHotspot.bind(this),\n            removeAll: this.removeAllHotspots.bind(this),\n            list: this.getPointerNodeHotspots.bind(this),\n            setVisibility: this.setStateById.bind(this),\n            enable: this.enable.bind(this),\n            disable: this.disable.bind(this)\n        };\n\n        this.setEvents();\n    }\n\n    setOriginImageSize(width, height) {\n        this.originImageSize = {\n            width: width,\n            height: height\n        };\n    }\n\n    appendTo(container) {\n        this.container.appendTo(container);\n    }\n\n    setInstanceComponentNode(instance) {\n        this.instanceComponentNode = instance;\n    }\n\n    setContainerSize(instNodeBoundingClientRect) {\n        if (!this.hotspots.length || !instNodeBoundingClientRect) {\n            return;\n        }\n\n        const componentSize = this.getRightBoundengClientRect();\n\n        this.container.setCss({\n            top: instNodeBoundingClientRect.top - componentSize.top,\n            left: instNodeBoundingClientRect.left - componentSize.left,\n            width: ((instNodeBoundingClientRect.width * 100) / componentSize.width) + '%',\n            height: ((instNodeBoundingClientRect.height * 100) / componentSize.height) + '%'\n        });\n\n        const size = this.container.getSize();\n        const dx = size.width / this.originImageSize.width;\n        const dy = size.height / this.originImageSize.height;\n        this.hotspots.forEach(hs => hs.setAspectRatio(dx, dy));\n    }\n\n    getActiveHotspot(id) {\n        return this.activeHotspots.filter(hs => hs.id === id)[0] || null;\n    }\n\n    getHoveredHotspots(id) {\n        return this.hoveredHotspots.filter(hs => hs.id === id)[0] || null;\n    }\n\n    setEvents() {\n        this.on('hotspotActivate', (e) => {\n            const activeHotspot = this.getActiveHotspot(e.data.hotspot.id);\n            if (!activeHotspot) {\n                e.stopEmptyEvent();\n                this.activeHotspots.forEach((hs) => {\n                    if (!hs.isBoxAlwaysVisible()) {\n                        hs.hideBox(true);\n                    }\n                });\n\n                this.activeHotspots.push(e.data.hotspot);\n                this.activeHotspots[this.activeHotspots.length - 1].overridePointerEvent();\n                e.data.id = e.data.hotspot.id;\n                delete e.data.hotspot;\n            }\n        });\n\n        this.on('hotspotDeactivate', (e) => {\n            e.stopEmptyEvent();\n            const activeHotspot = this.getActiveHotspot(e.data.hotspot.id);\n            if (activeHotspot) {\n                activeHotspot.removeOverridePointerEvent();\n                this.activeHotspots = this.activeHotspots.filter(hs => hs.id !== activeHotspot.id);\n            }\n            e.data.id = e.data.hotspot.id;\n            delete e.data.hotspot;\n        });\n\n        this.on('hotspotHovered', (e) => {\n            const hoveredHotspot = this.getHoveredHotspots(e.data.hotspot.id);\n            if (!hoveredHotspot) {\n                e.stopAll();\n                this.hoveredHotspots.push(e.data.hotspot);\n            }\n        });\n\n        this.on('hotspotLeft', (e) => {\n            e.stopAll();\n\n            const hoveredHotspot = this.getHoveredHotspots(e.data.hotspot.id);\n            if (hoveredHotspot) {\n                this.hoveredHotspots = this.hoveredHotspots.filter(hs => hs.id !== hoveredHotspot.id);\n            }\n        });\n\n        this.clickFn = (e) => {\n            this.activeHotspots.forEach((hs) => {\n                if (!hs.isBoxAlwaysVisible()) {\n                    hs.hideBox(true);\n                }\n            });\n\n            this.hoveredHotspots.forEach((hs) => {\n                if (!hs.isTooltipAlwaysVisible()) {\n                    hs.hideTooltip(true);\n                }\n            });\n        };\n\n        $($J.D).addEvent('click', this.clickFn);\n    }\n\n    isHotspotActivated() {\n        return this.activeHotspots.length > 0;\n    }\n\n    createHotspots(hotspotsData) {\n        if (hotspotsData && hotspotsData.length) {\n            hotspotsData.forEach((data) => {\n                this.createHotspot(data, this.hotspots.length);\n            });\n        }\n    }\n\n    createHotspot(hotspotData, index) {\n        const hotspot = new Hotspot(this.container, hotspotData, index);\n        hotspot.setParent(this);\n        this.hotspots.push(hotspot);\n    }\n\n    addHotspot(hotspotsData) {\n        if (!Array.isArray(hotspotsData)) {\n            hotspotsData = [hotspotsData];\n        }\n\n        this.createHotspots(hotspotsData, this.hotspots.length);\n    }\n\n    getRightBoundengClientRect(hotspotsContainer) {\n        if (!this.hotspots.length) {\n            return this.instanceComponentNode ? this.instanceComponentNode.node.getBoundingClientRect() : hotspotsContainer.node.getBoundingClientRect();\n        }\n\n        return this.container.node.parentNode.getBoundingClientRect();\n    }\n\n    changeBoxContainerParent(inside) {\n        const c = inside ? this.container : null;\n        this.hotspots.forEach((hotspot) => {\n            hotspot.changeBoxContainer(c);\n        });\n    }\n\n    hideActiveHotspotBox(flag) {\n        const result = this.activeHotspots.length || this.hoveredHotspots.length;\n\n        this.activeHotspots.forEach((hs) => { hs.hideBox(flag); });\n        this.hoveredHotspots.forEach((hs) => { hs.hideTooltip(); });\n\n        return result;\n    }\n\n    show(index) {\n        const hs = this.hotspots[index];\n        if (hs) {\n            hs.show();\n        }\n    }\n\n    showAll() {\n        this.hotspots.forEach((hotspot) => {\n            hotspot.show();\n        });\n    }\n\n    hide(index) {\n        const hs = this.hotspots[index];\n        if (hs) {\n            hs.hide();\n        }\n    }\n\n    hideAll() {\n        this.hotspots.forEach((hotspot) => {\n            hotspot.hide();\n        });\n    }\n\n    enable(index) {\n        const hs = this.hotspots[index];\n        if (hs) {\n            hs.enable();\n            hs.show();\n        }\n    }\n\n    disable(index) {\n        if (this.hotspots[index]) {\n            this.hotspots[index].disable();\n        }\n    }\n\n    enableAll() {\n        this.hotspots.forEach((hotspot) => {\n            hotspot.enable();\n            hotspot.show();\n        });\n    }\n\n    disableAll() {\n        this.hotspots.forEach((hotspot) => {\n            hotspot.disable();\n        });\n    }\n\n    showNeededElements() {\n        this.hotspots.forEach((hs) => {\n            if (hs.isEnabled() && hs.isHotspotShown()) {\n                if (hs.isBoxAlwaysVisible()) {\n                    if (hs.isBoxActivated()) {\n                        hs.setBoxPosition();\n                    }\n                    hs.showBox();\n                }\n\n                if (hs.isTooltipAlwaysVisible()) {\n                    if (hs.isTooltipHovered()) {\n                        hs.setTooltipPosition();\n                    }\n                    hs.showTooltip();\n                }\n            }\n        });\n    }\n\n    getHotspots() {\n        return this.hotspots;\n    }\n\n    getPointerNodeHotspots() {\n        const pointers = [];\n\n        this.hotspots.forEach((hotspot) => {\n            pointers.push(hotspot.getHotspotPointer());\n        });\n\n        return pointers;\n    }\n\n    removeHotspot(index) {\n        const hs = this.hotspots[index];\n        if (hs) {\n            hs.disable();\n            hs.destroy();\n            this.removeByIndex(index);\n\n            if (!this.hotspots.length) {\n                this.container.remove();\n            }\n        }\n    }\n\n    removeAllHotspots() {\n        for (let i = this.hotspots.length - 1; i >= 0; i--) {\n            this.removeHotspot(i);\n        }\n    }\n\n    removeByIndex(index) {\n        this.hotspots.splice(index, 1);\n\n        if ((this.hotspots.length > 0 && index === 0) || (index > 0 && index <= this.hotspots.length - 1)) {\n            this.rewriteHotspotIndex(index);\n        }\n    }\n\n    rewriteHotspotIndex(startIndex) {\n        for (let index = startIndex, l = this.hotspots.length; index < l; index++) {\n            this.hotspots[index].setId(index);\n            this.hotspots[index].rewriteAttrPointer();\n        }\n    }\n\n    setStateById(index, settings) {\n        if (this.hotspots[index]) {\n            this.hotspots[index].setState(settings);\n        }\n    }\n\n    destroy() {\n        $($J.D).removeEvent('click', this.clickFn);\n\n        this.hotspots.forEach((hotspot) => {\n            hotspot.destroy();\n        });\n\n        this.container = null;\n        this.activeHotspots = [];\n        this.hoveredHotspots = [];\n\n        this.instanceComponentNode = null;\n\n        this.off('hotspotActivate');\n        this.off('hotspotDeactivate');\n        this.off('hotspotHovered');\n        this.off('hotspotLeft');\n        this.hotspots = null;\n        super.destroy();\n    }\n}\n\nreturn Hotspots;\n\n    }\n);\n"],"file":"hotspots.js"}